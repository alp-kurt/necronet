const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll-0UnZv7rS.js","./webworkerAll-CObAggr0.js","./colorToUniform-C2GHuDhf.js","./CanvasPool-BFix2TSZ.js","./WebGPURenderer-Cq185Bfw.js","./SharedSystems-fccy_fAE.js","./WebGLRenderer-oNX7jt-i.js"])))=>i.map(i=>d[i]);
var xa=Object.defineProperty;var _a=(s,t,e)=>t in s?xa(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var nt=(s,t,e)=>_a(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();const ba="modulepreload",wa=function(s,t){return new URL(s,t).href},Oi={},je=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),h=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(e.map(c=>{if(c=wa(c,i),c in Oi)return;Oi[c]=!0;const l=c.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(!!i)for(let g=o.length-1;g>=0;g--){const _=o[g];if(_.href===c&&(!l||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":ba,l||(u.as="script"),u.crossOrigin="",u.href=c,h&&u.setAttribute("nonce",h),document.head.appendChild(u),l)return new Promise((g,_)=>{u.addEventListener("load",g),u.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var Y=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(Y||{});const Vs=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Re=(s,t)=>Vs(s).priority??t,wt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Vs).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(Vs).forEach(t=>{t.type.forEach(e=>{var n,o;const i=this._addHandlers,r=this._queue;i[e]?(o=i[e])==null||o.call(i,t):(r[e]=r[e]||[],(n=r[e])==null||n.push(t))})}),this},handle(s,t,e){var o;const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&((o=n[s])==null||o.forEach(a=>t(a)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(n=>n.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((n,o)=>Re(o.value,e)-Re(n.value,e)))},i=>{const r=t.findIndex(n=>n.name===i.name);r!==-1&&t.splice(r,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>Re(n,e)-Re(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},Sa={extension:{type:Y.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await je(()=>import("./browserAll-0UnZv7rS.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)}},va={extension:{type:Y.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await je(()=>import("./webworkerAll-CObAggr0.js"),__vite__mapDeps([1,2,3]),import.meta.url)}};class ft{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new ft(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function mi(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var cs={exports:{}},$i;function Ca(){return $i||($i=1,function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,c,l){this.fn=h,this.context=c,this.once=l||!1}function n(h,c,l,d,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var u=new r(l,d||h,f),g=e?e+c:c;return h._events[g]?h._events[g].fn?h._events[g]=[h._events[g],u]:h._events[g].push(u):(h._events[g]=u,h._eventsCount++),h}function o(h,c){--h._eventsCount===0?h._events=new i:delete h._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],l,d;if(this._eventsCount===0)return c;for(d in l=this._events)t.call(l,d)&&c.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},a.prototype.listeners=function(c){var l=e?e+c:c,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,u=d.length,g=new Array(u);f<u;f++)g[f]=d[f].fn;return g},a.prototype.listenerCount=function(c){var l=e?e+c:c,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,l,d,f,u,g){var _=e?e+c:c;if(!this._events[_])return!1;var m=this._events[_],b=arguments.length,w,S;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),b){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,d),!0;case 4:return m.fn.call(m.context,l,d,f),!0;case 5:return m.fn.call(m.context,l,d,f,u),!0;case 6:return m.fn.call(m.context,l,d,f,u,g),!0}for(S=1,w=new Array(b-1);S<b;S++)w[S-1]=arguments[S];m.fn.apply(m.context,w)}else{var A=m.length,k;for(S=0;S<A;S++)switch(m[S].once&&this.removeListener(c,m[S].fn,void 0,!0),b){case 1:m[S].fn.call(m[S].context);break;case 2:m[S].fn.call(m[S].context,l);break;case 3:m[S].fn.call(m[S].context,l,d);break;case 4:m[S].fn.call(m[S].context,l,d,f);break;default:if(!w)for(k=1,w=new Array(b-1);k<b;k++)w[k-1]=arguments[k];m[S].fn.apply(m[S].context,w)}}return!0},a.prototype.on=function(c,l,d){return n(this,c,l,d,!1)},a.prototype.once=function(c,l,d){return n(this,c,l,d,!0)},a.prototype.removeListener=function(c,l,d,f){var u=e?e+c:c;if(!this._events[u])return this;if(!l)return o(this,u),this;var g=this._events[u];if(g.fn)g.fn===l&&(!f||g.once)&&(!d||g.context===d)&&o(this,u);else{for(var _=0,m=[],b=g.length;_<b;_++)(g[_].fn!==l||f&&!g[_].once||d&&g[_].context!==d)&&m.push(g[_]);m.length?this._events[u]=m.length===1?m[0]:m:o(this,u)}return this},a.prototype.removeAllListeners=function(c){var l;return c?(l=e?e+c:c,this._events[l]&&o(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a}(cs)),cs.exports}var Aa=Ca();const Rt=mi(Aa),Ta=Math.PI*2,Ma=180/Math.PI,Pa=Math.PI/180;class lt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new lt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return ls.x=0,ls.y=0,ls}}const ls=new lt;class z{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new lt;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new lt;const i=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,h=this.ty,c=1/(i*o+n*-r),l=t.x,d=t.y;return e.x=o*c*l+-n*c*d+(h*n-a*o)*c,e.y=i*c*d+-r*c*l+(-h*i+a*r)*c,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,e){const i=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,h=t.ty,c=e.a,l=e.b,d=e.c,f=e.d;return this.a=i*c+r*d,this.b=i*l+r*f,this.c=n*c+o*d,this.d=n*l+o*f,this.tx=a*c+h*d+e.tx,this.ty=a*l+h*f+e.ty,this}setTransform(t,e,i,r,n,o,a,h,c){return this.a=Math.cos(a+c)*n,this.b=Math.sin(a+c)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),c=Math.abs(a+h);return c<1e-5||Math.abs(Ta-c)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new z;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return Ea.identity()}static get shared(){return Ia.identity()}}const Ia=new z,Ea=new z,Yt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Xt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],qt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Kt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],js=[],bn=[],Be=Math.sign;function ka(){for(let s=0;s<16;s++){const t=[];js.push(t);for(let e=0;e<16;e++){const i=Be(Yt[s]*Yt[e]+qt[s]*Xt[e]),r=Be(Xt[s]*Yt[e]+Kt[s]*Xt[e]),n=Be(Yt[s]*qt[e]+qt[s]*Kt[e]),o=Be(Xt[s]*qt[e]+Kt[s]*Kt[e]);for(let a=0;a<16;a++)if(Yt[a]===i&&Xt[a]===r&&qt[a]===n&&Kt[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new z;t.set(Yt[s],Xt[s],qt[s],Kt[s],0,0),bn.push(t)}}ka();const Q={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Yt[s],uY:s=>Xt[s],vX:s=>qt[s],vY:s=>Kt[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>js[s][t],sub:(s,t)=>js[s][Q.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?Q.S:Q.N:Math.abs(t)*2<=Math.abs(s)?s>0?Q.E:Q.W:t>0?s>0?Q.SE:Q.SW:s>0?Q.NE:Q.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=bn[Q.inv(t)];r.tx=e,r.ty=i,s.append(r)}},Fe=[new lt,new lt,new lt,new lt];class ht{constructor(t=0,e=0,i=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ht(0,0,0,0)}clone(){return new ht(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i,r=.5){const{width:n,height:o}=this;if(n<=0||o<=0)return!1;const a=this.x,h=this.y,c=i*(1-r),l=i-c,d=a-c,f=a+n+c,u=h-c,g=h+o+c,_=a+l,m=a+n-l,b=h+l,w=h+o-l;return t>=d&&t<=f&&e>=u&&e<=g&&!(t>_&&t<m&&e>b&&e<w)}intersects(t,e){if(!e){const N=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=N)return!1;const R=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>R}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=Fe[0].set(t.left,t.top),h=Fe[1].set(t.left,t.bottom),c=Fe[2].set(t.right,t.top),l=Fe[3].set(t.right,t.bottom);if(c.x<=a.x||h.y<=a.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(a,a),e.apply(h,h),e.apply(c,c),e.apply(l,l),Math.max(a.x,h.x,c.x,l.x)<=i||Math.min(a.x,h.x,c.x,l.x)>=r||Math.max(a.y,h.y,c.y,l.y)<=n||Math.min(a.y,h.y,c.y,l.y)>=o))return!1;const f=d*(h.y-a.y),u=d*(a.x-h.x),g=f*i+u*n,_=f*r+u*n,m=f*i+u*o,b=f*r+u*o;if(Math.max(g,_,m,b)<=f*a.x+u*a.y||Math.min(g,_,m,b)>=f*l.x+u*l.y)return!1;const w=d*(a.y-c.y),S=d*(c.x-a.x),A=w*i+S*n,k=w*r+S*n,P=w*i+S*o,I=w*r+S*o;return!(Math.max(A,k,P,I)<=w*a.x+S*a.y||Math.min(A,k,P,I)>=w*l.x+S*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}getBounds(t){return t||(t=new ht),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,i=t.y,r=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height&&r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const us={default:-1};function rt(s="default"){return us[s]===void 0&&(us[s]=-1),++us[s]}const zi={},et="8.0.0",Ra="8.3.4";function q(s,t,e=3){if(zi[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),zi[t]=!0}const wn=()=>{};function Hi(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Wi(s){return!(s&s-1)&&!!s}function Sn(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const Ui=Object.create(null);function Ba(s){const t=Ui[s];return t===void 0&&(Ui[s]=rt("resource")),t}const vn=class Cn extends Rt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Cn.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){q(et,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=Ba(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};vn.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Fa=vn;const An=class Tn extends Rt{constructor(t={}){super(),this.options=t,this.uid=rt("textureSource"),this._resourceType="textureSource",this._resourceId=rt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Tn.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Fa(Sn(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,i;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=rt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i||(i=this._resolution),t||(t=this.width),e||(e=this.height);const r=Math.round(t*i),n=Math.round(e*i);return this.width=r/i,this.height=n/i,this._resolution=i,this.pixelWidth===r&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this._resourceId=rt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Wi(this.pixelWidth)&&Wi(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};An.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Bt=An;class gi extends Bt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}gi.extension=Y.TextureSource;const Vi=new z;class Da{constructor(t,e){this.mapCoord=new z,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,r=t.trim;r&&(Vi.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Vi));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,h=this.clampOffset/n._resolution;return o[0]=(t.frame.x+a+h)/n.width,o[1]=(t.frame.y+a+h)/n.height,o[2]=(t.frame.x+t.frame.width-a+h)/n.width,o[3]=(t.frame.y+t.frame.height-a+h)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}class j extends Rt{constructor({source:t,label:e,frame:i,orig:r,trim:n,defaultAnchor:o,defaultBorders:a,rotate:h,dynamic:c}={}){if(super(),this.uid=rt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ht,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Bt,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:l,height:d}=this._source;this.frame.width=l,this.frame.height=d}this.orig=r||this.frame,this.trim=n,this.rotate=h??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Da(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:r}=this._source,n=e.x/i,o=e.y/r,a=e.width/i,h=e.height/r;let c=this.rotate;if(c){const l=a/2,d=h/2,f=n+l,u=o+d;c=Q.add(c,Q.NW),t.x0=f+l*Q.uX(c),t.y0=u+d*Q.uY(c),c=Q.add(c,2),t.x1=f+l*Q.uX(c),t.y1=u+d*Q.uY(c),c=Q.add(c,2),t.x2=f+l*Q.uX(c),t.y2=u+d*Q.uY(c),c=Q.add(c,2),t.x3=f+l*Q.uX(c),t.y3=u+d*Q.uY(c)}else t.x0=n,t.y0=o,t.x1=n+a,t.y1=o,t.x2=n+a,t.y2=o+h,t.x3=n,t.y3=o+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return q(et,"Texture.baseTexture is now Texture.source"),this._source}}j.EMPTY=new j({label:"EMPTY",source:new Bt({label:"EMPTY"})});j.EMPTY.destroy=wn;j.WHITE=new j({source:new gi({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});j.WHITE.destroy=wn;function Ga(s,t,e){const{width:i,height:r}=e.orig,n=e.trim;if(n){const o=n.width,a=n.height;s.minX=n.x-t._x*i,s.maxX=s.minX+o,s.minY=n.y-t._y*r,s.maxY=s.minY+a}else s.minX=-t._x*i,s.maxX=s.minX+i,s.minY=-t._y*r,s.maxY=s.minY+r}const ji=new z;class At{constructor(t=1/0,e=1/0,i=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ji,this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ht);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ji,this}set(t,e,i,r){this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}addFrame(t,e,i,r,n){n||(n=this.matrix);const o=n.a,a=n.b,h=n.c,c=n.d,l=n.tx,d=n.ty;let f=this.minX,u=this.minY,g=this.maxX,_=this.maxY,m=o*t+h*e+l,b=a*t+c*e+d;m<f&&(f=m),b<u&&(u=b),m>g&&(g=m),b>_&&(_=b),m=o*i+h*e+l,b=a*i+c*e+d,m<f&&(f=m),b<u&&(u=b),m>g&&(g=m),b>_&&(_=b),m=o*t+h*r+l,b=a*t+c*r+d,m<f&&(f=m),b<u&&(u=b),m>g&&(g=m),b>_&&(_=b),m=o*i+h*r+l,b=a*i+c*r+d,m<f&&(f=m),b<u&&(u=b),m>g&&(g=m),b>_&&(_=b),this.minX=f,this.minY=u,this.maxX=g,this.maxY=_}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:h,d:c,tx:l,ty:d}=t;let f=o*e+h*i+l,u=a*e+c*i+d;this.minX=f,this.minY=u,this.maxX=f,this.maxY=u,f=o*r+h*i+l,u=a*r+c*i+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*e+h*n+l,u=a*e+c*n+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY,f=o*r+h*n+l,u=a*r+c*n+d,this.minX=f<this.minX?f:this.minX,this.minY=u<this.minY?u:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=u>this.maxY?u:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,r){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>r&&(this.maxY=r),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new At(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,r){let n=this.minX,o=this.minY,a=this.maxX,h=this.maxY;r||(r=this.matrix);const c=r.a,l=r.b,d=r.c,f=r.d,u=r.tx,g=r.ty;for(let _=e;_<i;_+=2){const m=t[_],b=t[_+1],w=c*m+d*b+u,S=l*m+f*b+g;n=w<n?w:n,o=S<o?S:o,a=w>a?w:a,h=S>h?S:h}this.minX=n,this.minY=o,this.maxX=a,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var La={grad:.9,turn:360,rad:360/(2*Math.PI)},Gt=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},at=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},bt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},Mn=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Yi=function(s){return{r:bt(s.r,0,255),g:bt(s.g,0,255),b:bt(s.b,0,255),a:bt(s.a)}},ds=function(s){return{r:at(s.r),g:at(s.g),b:at(s.b),a:at(s.a,3)}},Na=/^#([0-9a-f]{3,8})$/i,De=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},Pn=function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=Math.max(t,e,i),o=n-Math.min(t,e,i),a=o?n===t?(e-i)/o:n===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},In=function(s){var t=s.h,e=s.s,i=s.v,r=s.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),o=i*(1-e),a=i*(1-(t-n)*e),h=i*(1-(1-t+n)*e),c=n%6;return{r:255*[i,a,o,o,h,i][c],g:255*[h,i,i,a,o,o][c],b:255*[o,o,h,i,i,a][c],a:r}},Xi=function(s){return{h:Mn(s.h),s:bt(s.s,0,100),l:bt(s.l,0,100),a:bt(s.a)}},qi=function(s){return{h:at(s.h),s:at(s.s),l:at(s.l),a:at(s.a,3)}},Ki=function(s){return In((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},Se=function(s){return{h:(t=Pn(s)).h,s:(r=(200-(e=t.s))*(i=t.v)/100)>0&&r<200?e*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,i,r},Oa=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$a=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,za=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ha=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ys={string:[[function(s){var t=Na.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?at(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?at(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=za.exec(s)||Ha.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Yi({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=Oa.exec(s)||$a.exec(s);if(!t)return null;var e,i,r=Xi({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(La[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Ki(r)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=r===void 0?1:r;return Gt(t)&&Gt(e)&&Gt(i)?Yi({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,r=s.a,n=r===void 0?1:r;if(!Gt(t)||!Gt(e)||!Gt(i))return null;var o=Xi({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return Ki(o)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,r=s.a,n=r===void 0?1:r;if(!Gt(t)||!Gt(e)||!Gt(i))return null;var o=function(a){return{h:Mn(a.h),s:bt(a.s,0,100),v:bt(a.v,0,100),a:bt(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return In(o)},"hsv"]]},Zi=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},Wa=function(s){return typeof s=="string"?Zi(s.trim(),Ys.string):typeof s=="object"&&s!==null?Zi(s,Ys.object):[null,void 0]},fs=function(s,t){var e=Se(s);return{h:e.h,s:bt(e.s+100*t,0,100),l:e.l,a:e.a}},ps=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Qi=function(s,t){var e=Se(s);return{h:e.h,s:e.s,l:bt(e.l+100*t,0,100),a:e.a}},Xs=function(){function s(t){this.parsed=Wa(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return at(ps(this.rgba),2)},s.prototype.isDark=function(){return ps(this.rgba)<.5},s.prototype.isLight=function(){return ps(this.rgba)>=.5},s.prototype.toHex=function(){return t=ds(this.rgba),e=t.r,i=t.g,r=t.b,o=(n=t.a)<1?De(at(255*n)):"","#"+De(e)+De(i)+De(r)+o;var t,e,i,r,n,o},s.prototype.toRgb=function(){return ds(this.rgba)},s.prototype.toRgbString=function(){return t=ds(this.rgba),e=t.r,i=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+r+", "+n+")":"rgb("+e+", "+i+", "+r+")";var t,e,i,r,n},s.prototype.toHsl=function(){return qi(Se(this.rgba))},s.prototype.toHslString=function(){return t=qi(Se(this.rgba)),e=t.h,i=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+r+"%, "+n+")":"hsl("+e+", "+i+"%, "+r+"%)";var t,e,i,r,n},s.prototype.toHsv=function(){return t=Pn(this.rgba),{h:at(t.h),s:at(t.s),v:at(t.v),a:at(t.a,3)};var t},s.prototype.invert=function(){return Et({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Et(fs(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Et(fs(this.rgba,-t))},s.prototype.grayscale=function(){return Et(fs(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Et(Qi(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Et(Qi(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Et({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):at(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=Se(this.rgba);return typeof t=="number"?Et({h:t,s:e.s,l:e.l,a:e.a}):at(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Et(t).toHex()},s}(),Et=function(s){return s instanceof Xs?s:new Xs(s)},Ji=[],Ua=function(s){s.forEach(function(t){Ji.indexOf(t)<0&&(t(Xs,Ys),Ji.push(t))})};function Va(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in e)i[e[r]]=r;var n={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,c=i[this.toHex()];if(c)return c;if(o!=null&&o.closest){var l=this.toRgb(),d=1/0,f="black";if(!n.length)for(var u in e)n[u]=new s(e[u]).toRgb();for(var g in e){var _=(a=l,h=n[g],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));_<d&&(d=_,f=g)}return f}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new s(h).toRgb():null},"name"])}Ua([Va]);const fe=class _e{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof _e)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,o)=>n===e[o]);if(t!==null&&e!==null){const n=Object.keys(t),o=Object.keys(e);return n.length!==o.length?!1:n.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,i,r]=this._components;return{r:t,g:e,b:i,a:r}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,i,r,n]=this._components;return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,i,r]=this._components;return t[0]=e,t[1]=i,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,r,n]=_e._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=r,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,r=r*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(r<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,r,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,r=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,r,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,r,n=255]=t,e/=255,i/=255,r/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=_e.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Et(t);o.isValid()&&({r:e,g:i,b:r,a:n}=o.rgba,e/=255,i/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=r,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((r,n)=>{t[n]=Math.min(Math.max(r,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof _e||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};fe.shared=new fe;fe._temp=new fe;fe.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ut=fe;const ja={cullArea:null,cullable:!1,cullableChildren:!0};class yi{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var i;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(i=e.init)==null||i.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Ya{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new yi(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Lt=new Ya,Xa={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){q("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function qa(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}const Ka={allowChildren:!0,removeChildren(s=0,t){const e=t??this.children.length,i=e-s,r=[];if(i>0&&i<=e){for(let o=e-1;o>=s;o--){const a=this.children[o];a&&(r.push(a),a.parent=null)}qa(this.children,s,e);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(r);for(let o=0;o<r.length;++o)this.emit("childRemoved",r[o],this,o),r[o].emit("removed",this);return r.length>0&&this._didViewChangeTick++,r}else if(i===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||q(et,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const r=s.parent.children.indexOf(s);if(s.parent===this&&r===t)return s;r!==-1&&s.parent.children.splice(r,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const i=this.worldTransform.clone();return i.invert(),e.prepend(i),s.setFromMatrix(e),s}},Za={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const i=this.children,r=i.length;for(let n=0;n<r;n++)i[n].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:i}=t;for(let r=0;r<this.effects.length;r++){const n=this.effects[r];i[n.pipe].push(n,this,s)}this.collectRenderablesSimple(s,t,e);for(let r=this.effects.length-1;r>=0;r--){const n=this.effects[r];i[n.pipe].pop(n,this,s)}}};class tr{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Qa{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return Lt.get(i.maskClass,t)}return t}returnMaskEffect(t){Lt.return(t)}}const qs=new Qa;wt.handleByList(Y.MaskEffect,qs._effectClasses);const Ja={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,i)=>e.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),qs.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=qs.getMaskEffect(s),this.addEffect(this._maskEffect)))},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},set filters(s){var n;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new tr);s=s;const e=(s==null?void 0:s.length)>0,i=((n=t.filters)==null?void 0:n.length)>0,r=e!==i;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),r&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new tr),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},th={label:null,get name(){return q(et,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){q(et,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const r=e[i];if(r.label===s||s instanceof RegExp&&s.test(r.label))return r}if(t)for(let i=0;i<e.length;i++){const n=e[i].getChildByLabel(s,!0);if(n)return n}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let r=0;r<i.length;r++){const n=i[r];(n.label===s||s instanceof RegExp&&s.test(n.label))&&e.push(n)}if(t)for(let r=0;r<i.length;r++)i[r].getChildrenByLabel(s,!0,e);return e}},dt=new yi(z),Nt=new yi(At),eh=new z,sh={getFastGlobalBounds(s,t){t||(t=new At),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let i=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(i=Nt.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;i.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const n=this.children;for(let o=0;o<n.length;o++)n[o]._getGlobalBoundsRecursive(s,i,e)}if(r){let n=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(n||(n=!0,i.applyMatrix(o.worldTransform)),this.effects[a].addBounds(i,!0));n&&(i.applyMatrix(o.worldTransform.copyTo(eh).invert()),t.addBounds(i,this.relativeGroupTransform)),t.addBounds(i),Nt.return(i)}else this.renderGroup&&(t.addBounds(i,this.relativeGroupTransform),Nt.return(i))}};function En(s,t,e){e.clear();let i,r;return s.parent?t?i=s.parent.worldTransform:(r=dt.get().identity(),i=xi(s,r)):i=z.IDENTITY,kn(s,e,i,t),r&&dt.return(r),e.isValid||e.set(0,0,0,0),e}function kn(s,t,e,i){var a,h;if(!s.visible||!s.measurable)return;let r;i?r=s.worldTransform:(s.updateLocalTransform(),r=dt.get(),r.appendFrom(s.localTransform,e));const n=t,o=!!s.effects.length;if(o&&(t=Nt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.bounds&&(t.matrix=r,t.addBounds(s.bounds));for(let c=0;c<s.children.length;c++)kn(s.children[c],t,r,i)}if(o){for(let c=0;c<s.effects.length;c++)(h=(a=s.effects[c]).addBounds)==null||h.call(a,t);n.addBounds(t,z.IDENTITY),Nt.return(t)}i||dt.return(r)}function xi(s,t){const e=s.parent;return e&&(xi(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Rn(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,i=s>>8&255,r=s&255,n=t>>16&255,o=t>>8&255,a=t&255,h=e*n/255|0,c=i*o/255|0,l=r*a/255|0;return(h<<16)+(c<<8)+l}const er=16777215;function sr(s,t){return s===er?t:t===er?s:Rn(s,t)}function We(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const ih={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=xi(this,dt.get().identity());return s.appendFrom(this.localTransform,e),dt.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?We(this.renderGroup.worldColor):this.parentRenderGroup?We(sr(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=sr(t,e.localColor),e=e.parent;return We(t)}};let ms=0;const ir=500;function xt(...s){ms!==ir&&(ms++,ms===ir?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}function Bn(s,t,e){return t.clear(),e||(e=z.IDENTITY),Fn(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function Fn(s,t,e,i,r){var h,c;let n;if(r)n=dt.get(),n=e.copyTo(n);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const l=s.localTransform;n=dt.get(),n.appendFrom(l,e)}const o=t,a=!!s.effects.length;if(a&&(t=Nt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.renderPipeId&&(t.matrix=n,t.addBounds(s.bounds));const l=s.children;for(let d=0;d<l.length;d++)Fn(l[d],t,n,i,!1)}if(a){for(let l=0;l<s.effects.length;l++)(c=(h=s.effects[l]).addLocalBounds)==null||c.call(h,t,i);o.addBounds(t,z.IDENTITY),Nt.return(t)}dt.return(n)}function Dn(s,t){const e=s.children;for(let i=0;i<e.length;i++){const r=e[i],n=r.uid,o=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,a=t.index;(t.data[a]!==n||t.data[a+1]!==o)&&(t.data[t.index]=n,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,r.children.length&&Dn(r,t)}return t.didChange}const rh=new z,nh={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new At});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),Dn(this,s),s.didChange&&Bn(this,s.localBounds,rh),s.localBounds},getBounds(s,t){return En(this,s,t||new At)}},oh={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},ah={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(hh))}};function hh(s,t){return s._zIndex-t._zIndex}const ch={getGlobalPosition(s=new lt,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const i=this.getGlobalTransform(dt.get(),e);return t=i.apply(s,t),dt.return(i),t},toLocal(s,t,e,i){t&&(s=t.toGlobal(s,e,i));const r=this.getGlobalTransform(dt.get(),i);return e=r.applyInverse(s,e),dt.return(r),e}};class Gn{constructor(){this.uid=rt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let lh=0;class uh{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,i){const r=new Bt({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!1});return new j({source:r,label:`texturePool_${lh++}`})}getOptimalTexture(t,e,i=1,r){let n=Math.ceil(t*i-1e-6),o=Math.ceil(e*i-1e-6);n=Hi(n),o=Hi(o);const a=(n<<17)+(o<<1)+(r?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let h=this._texturePool[a].pop();return h||(h=this.createTexture(n,o,r)),h.source._resolution=i,h.source.width=n/i,h.source.height=o/i,h.source.pixelWidth=n,h.source.pixelHeight=o,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=a,h}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t){const e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const i=this._texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this._texturePool={}}}const dh=new uh;class fh{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new z,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Gn,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let i=0;i<e.length;i++){const r=e[i];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(dh.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let i=0;i<e.length;i++)this.removeChild(e[i])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let r=0;r<i.length;r++)this._getChildren(i[r],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new z),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new z),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new z),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function ph(s,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(s[i]=t[i])}const gs=new ft(null),ys=new ft(null),xs=new ft(null,1,1),rr=1,mh=2,_s=4;class J extends Rt{constructor(t={}){var e,i;super(),this.uid=rt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new z,this.relativeGroupTransform=new z,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ft(this,0,0),this._scale=xs,this._pivot=ys,this._skew=gs,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],ph(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(r=>this.addChild(r)),(i=t.parent)==null||i.addChild(this)}static mixin(t){q("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),wt.mixin(J,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||q(et,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let r=0;r<t.length;r++)this.addChild(t[r]);return t[0]}const e=t[0],i=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),i&&(i.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Lt.get(fh,this),this.groupTransform=z.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Lt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new z),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*Ma}set angle(t){this.rotation=t*Pa}get pivot(){return this._pivot===ys&&(this._pivot=new ft(this,0,0)),this._pivot}set pivot(t){this._pivot===ys&&(this._pivot=new ft(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===gs&&(this._skew=new ft(this,0,0)),this._skew}set skew(t){this._skew===gs&&(this._skew=new ft(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===xs&&(this._scale=new ft(this,1,1)),this._scale}set scale(t){this._scale===xs&&(this._scale=new ft(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,i.width),e!==void 0&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,r=this._pivot,n=this._position,o=i._x,a=i._y,h=r._x,c=r._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*a,e.d=this._sy*a,e.tx=n._x-(h*e.a+c*e.c),e.ty=n._y-(h*e.b+c*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=rr,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=ut.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=rr,this._onUpdate())}get tint(){return We(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mh,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=_s,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=_s,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=_s,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var r;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let n=0;n<e.length;++n)e[n].destroy(t);(r=this.renderGroup)==null||r.destroy(),this.renderGroup=null}}wt.mixin(J,Ka,sh,ch,oh,nh,Ja,th,ah,ja,Xa,ih,Za);class _i extends J{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new At(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:r}=t;return i>=e.minX&&i<=e.maxX&&r>=e.minY&&r<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}collectRenderablesSimple(t,e,i){const{renderPipes:r,renderableGC:n}=e;r.blendMode.setBlendMode(this,this.groupBlendMode,t),r[this.renderPipeId].addRenderable(this,t),n.addRenderable(this),this.didViewUpdate=!1;const a=this.children,h=a.length;for(let c=0;c<h;c++)a[c].collectRenderables(t,e,i)}}class ee extends _i{constructor(t=j.EMPTY){t instanceof j&&(t={texture:t});const{texture:e=j.EMPTY,anchor:i,roundPixels:r,width:n,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new ft({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,n!==void 0&&(this.width=n),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof j?new ee(t):new ee(j.from(t,e))}set texture(t){t||(t=j.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Ga(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return q("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,i=this._bounds,{width:r,height:n}=e.orig;i.minX=-t._x*r,i.maxX=i.minX+r,i.minY=-t._y*n,i.maxY=i.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const gh=new At;function Ln(s,t,e){const i=gh;s.measurable=!0,En(s,e,i),t.addBoundsMask(i),s.measurable=!1}function Nn(s,t,e){const i=Nt.get();s.measurable=!0;const r=dt.get().identity(),n=On(s,e,r);Bn(s,i,n),s.measurable=!1,t.addBoundsMask(i),dt.return(r),Nt.return(i)}function On(s,t,e){return s?(s!==t&&(On(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(xt("Mask bounds, renderable is not inside the root container"),e)}class $n{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof ee),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Ln(this.mask,t,e)}addLocalBounds(t,e){Nn(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof ee}}$n.extension=Y.MaskEffect;class zn{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}zn.extension=Y.MaskEffect;class Hn{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Ln(this.mask,t,e)}addLocalBounds(t,e){Nn(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof J}}Hn.extension=Y.MaskEffect;const yh={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let nr=yh;const Ct={get(){return nr},set(s){nr=s}};class Wn extends Bt{constructor(t){t.resource||(t.resource=Ct.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const r=super.resize(t,e,i);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Wn.extension=Y.TextureSource;class Ye extends Bt{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=Ct.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,xt("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Ye.extension=Y.TextureSource;var Ks=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(Ks||{});class bs{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Un=class yt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new bs(null,null,1/0),this.deltaMS=1/yt.targetFPMS,this.elapsedMS=1/yt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=Ks.NORMAL){return this._addListener(new bs(t,e,i))}addOnce(t,e,i=Ks.NORMAL){return this._addListener(new bs(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*yt.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,yt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!yt._shared){const t=yt._shared=new yt;t.autoStart=!0,t._protected=!0}return yt._shared}static get system(){if(!yt._system){const t=yt._system=new yt;t.autoStart=!0,t._protected=!0}return yt._system}};Un.targetFPMS=.06;let Ge=Un,ws;async function xh(){return ws??(ws=(async()=>{var o;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const h=document.createElement("video");h.onloadeddata=()=>a(h),h.onerror=()=>a(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(r),t.deleteTexture(i),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),ws}const ss=class Vn extends Bt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Vn.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Ge.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await xh(),this._load=new Promise((i,r)=>{this.isValid?i(this):(this._resolve=i,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ge.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ge.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ge.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};ss.extension=Y.TextureSource;ss.defaultOptions={...Bt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ss.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let _h=ss;const ce=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(i=>typeof i=="string"||e?t(i):i):s);class bh{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||xt(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=ce(t);let r;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.test(e)){r=c.getCacheableAssets(i,e);break}}const n=new Map(Object.entries(r||{}));r||i.forEach(h=>{n.set(h,e)});const o=[...n.keys()],a={cacheKeys:o,keys:i};i.forEach(h=>{this._cacheMap.set(h,a)}),o.forEach(h=>{const c=r?r[h]:e;this._cache.has(h)&&this._cache.get(h)!==c&&xt("[Cache] already has key:",h),this._cache.set(h,n.get(h))})}remove(t){if(!this._cacheMap.has(t)){xt(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const le=new bh,Zs=[];wt.handleByList(Y.TextureSource,Zs);function jn(s={}){const t=s&&s.resource,e=t?s.resource:s,i=t?s:{resource:s};for(let r=0;r<Zs.length;r++){const n=Zs[r];if(n.test(e))return new n(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function wh(s={},t=!1){const e=s&&s.resource,i=e?s.resource:s,r=e?s:{resource:s};if(!t&&le.has(i))return le.get(i);const n=new j({source:jn(r)});return n.on("destroy",()=>{le.has(i)&&le.remove(i)}),t||le.set(i,n),n}function Sh(s,t=!1){return typeof s=="string"?le.get(s):s instanceof Bt?new j({source:s}):wh(s,t)}j.from=Sh;Bt.from=jn;wt.add($n,zn,Hn,_h,Ye,Wn,gi);var Yn=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(Yn||{});function St(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function me(s){return s.split("?")[0].split("#")[0]}function vh(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ch(s,t,e){return s.replace(new RegExp(vh(t),"g"),e)}function Ah(s,t){let e="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Me={toPosix(s){return Ch(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){St(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(St(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const i=me(this.toPosix(t??Ct.get().getBaseUrl())),r=me(this.toPosix(e??this.rootname(i)));return s=this.toPosix(s),s.startsWith("/")?Me.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(St(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Ah(s),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return St(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(St(i),i.length>0)if(t===void 0)t=i;else{const r=s[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(St(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,r=!0;const n=this.getProtocol(s),o=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(o)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){St(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){St(s),t&&St(t),s=me(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){const h=s.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){St(s),s=me(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){St(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=me(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let r;t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,c=s.length-1,l=0;for(;c>=r;--c){if(e=s.charCodeAt(c),e===47){if(!h){o=c+1;break}continue}a===-1&&(h=!1,a=c+1),e===46?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1)}return n===-1||a===-1||l===0||l===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&i?(t.name=s.slice(1,n),t.base=s.slice(1,a)):(t.name=s.slice(o,n),t.base=s.slice(o,a)),t.ext=s.slice(n,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Xn(s,t,e,i,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?Xn(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function Th(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),Xn(s,r,0,e,i)}else i.push(s);return i}const or=s=>!Array.isArray(s);class qn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return ce(e||i,n=>typeof n=="string"?n:Array.isArray(n)?n.map(o=>(o==null?void 0:o.src)??o):n!=null&&n.src?n.src:n,!0)}addManifest(t){this._manifest&&xt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([n,o])=>typeof o=="string"||Array.isArray(o)?{alias:n,src:o}:{alias:n,...o})),r.forEach(n=>{const o=n.src,a=n.alias;let h;if(typeof a=="string"){const c=this._createBundleAssetId(t,a);i.push(c),h=[a,c]}else{const c=a.map(l=>this._createBundleAssetId(t,l));i.push(...c),h=[...a,...c]}this.add({...n,alias:h,src:o})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=n=>{this.hasKey(n)&&xt(`[Resolver] already has key: ${n} overwriting`)},ce(e).forEach(n=>{const{src:o}=n;let{data:a,format:h,loadParser:c}=n;const l=ce(o).map(u=>typeof u=="string"?Th(u):Array.isArray(u)?u:[u]),d=this.getAlias(n);Array.isArray(d)?d.forEach(i):i(d);const f=[];l.forEach(u=>{u.forEach(g=>{let _={};if(typeof g!="object"){_.src=g;for(let m=0;m<this._parsers.length;m++){const b=this._parsers[m];if(b.test(g)){_=b.parse(g);break}}}else a=g.data??a,h=g.format??h,c=g.loadParser??c,_={..._,...g};if(!d)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this._buildResolvedAsset(_,{aliases:d,data:a,format:h,loadParser:c}),f.push(_)})}),d.forEach(u=>{this._assetMap[u]=f})})}resolveBundle(t){const e=or(t);t=ce(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const c=o[h];a[this._extractAssetIdFromBundle(r,h)]=c}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const r in e)i[r]=e[r].src;return i}return e.src}resolve(t){const e=or(t);t=ce(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n);o==null||o.priority.forEach(a=>{o.params[a].forEach(h=>{const c=n.filter(l=>l[a]?l[a]===h:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[e],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:r,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Me.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.format??Mh(t.src),t}}qn.RETINA_PREFIX=/@([0-9\.]+)x/;function Mh(s){return s.split(".").pop().split("?").shift().split("#").shift()}const ar=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},Kn=class be{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof j?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const i=parseFloat(e.meta.scale);i?(this.resolution=i,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=be.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=be.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const r=this._frameKeys[e],n=this._frames[r],o=n.frame;if(o){let a=null,h=null;const c=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,l=new ht(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);n.rotated?a=new ht(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ht(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new ht(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new j({source:this.textureSource,frame:a,orig:l,trim:h,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const r=t[e][i];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*be.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*be.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Kn.BATCH_SIZE=1e3;let hr=Kn;const Ph=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Zn(s,t,e){const i={};if(s.forEach(r=>{i[r]=t}),Object.keys(t.textures).forEach(r=>{i[r]=t.textures[r]}),!e){const r=Me.dirname(s[0]);t.linkedSheets.forEach((n,o)=>{const a=Zn([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(i,a)})}return i}const Ih={extension:Y.Asset,cache:{test:s=>s instanceof hr,getCacheableAssets:(s,t)=>Zn(s,t,!1)},resolver:{extension:{type:Y.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),r=e.pop();return i==="json"&&Ph.includes(r)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=qn.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:Y.LoadParser,priority:Yn.Normal,name:"spritesheetLoader"},async testParse(s,t){return Me.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var l,d;const{texture:i,imageFilename:r,textureOptions:n}=(t==null?void 0:t.data)??{};let o=Me.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(i instanceof j)a=i;else{const f=ar(o+(r??s.meta.image),t.src);a=(await e.load([{src:f,data:n}]))[f]}const h=new hr(a.source,s);await h.parse();const c=(l=s==null?void 0:s.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(c)){const f=[];for(const g of c){if(typeof g!="string")continue;let _=o+g;(d=t.data)!=null&&d.ignoreMultiPack||(_=ar(_,t.src),f.push(e.load({src:_,data:{textureOptions:n,ignoreMultiPack:!0}})))}const u=await Promise.all(f);h.linkedSheets=u,u.forEach(g=>{g.linkedSheets=[h].concat(h.linkedSheets.filter(_=>_!==g))})}return h},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};wt.add(Ih);const Ss=Object.create(null),cr=Object.create(null);function bi(s,t){let e=cr[s];return e===void 0&&(Ss[t]===void 0&&(Ss[t]=1),cr[s]=e=Ss[t]++),e}let ae;function Qn(){return(!ae||ae!=null&&ae.isContextLost())&&(ae=Ct.get().createCanvas().getContext("webgl",{})),ae}let Le;function Eh(){if(!Le){Le="mediump";const s=Qn();s&&s.getShaderPrecisionFormat&&(Le=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return Le}function kh(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function Rh(s,t,e){const i=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let r=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return r==="highp"&&i!=="highp"&&(r="mediump"),`precision ${r} float;
${s}`}else if(i!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function Bh(s,t){return t?`#version 300 es
${s}`:s}const Fh={},Dh={};function Gh(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?Fh:Dh;return i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function Lh(s,t){return t?s.replace("#version 300 es",""):s}const vs={stripVersion:Lh,ensurePrecision:Rh,addProgramDefines:kh,setProgramName:Gh,insertVersion:Bh},Cs=Object.create(null),Jn=class Qs{constructor(t){t={...Qs.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:Eh()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let r=t.fragment,n=t.vertex;Object.keys(vs).forEach(o=>{const a=i[o];r=vs[o](r,a,!0),n=vs[o](n,a,!1)}),this.fragment=r,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=bi(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Cs[e]||(Cs[e]=new Qs(t)),Cs[e]}};Jn.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let to=Jn;const lr={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Nh(s){return lr[s]??lr.float32}const Oh={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function $h({source:s,entryPoint:t}){const e={},i=s.indexOf(`fn ${t}`);if(i!==-1){const r=s.indexOf("->",i);if(r!==-1){const n=s.substring(i,r),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(n))!==null;){const h=Oh[a[3]]??"float32";e[a[2]]={location:parseInt(a[1],10),format:h,stride:Nh(h).stride,offset:0,instance:!1,start:0}}}}return e}function As(s){var d,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,c=(d=s.match(t))==null?void 0:d.map(u=>({group:parseInt(u.match(e)[1],10),binding:parseInt(u.match(i)[1],10),name:u.match(r)[2],isUniform:u.match(r)[1]==="<uniform>",type:u.match(n)[1]}));if(!c)return{groups:[],structs:[]};const l=((f=s.match(o))==null?void 0:f.map(u=>{const g=u.match(h)[1],_=u.match(a).reduce((m,b)=>{const[w,S]=b.split(":");return m[w.trim()]=S.trim(),m},{});return _?{name:g,members:_}:null}).filter(({name:u})=>c.some(g=>g.type===u)))??[];return{groups:c,structs:l}}var we=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(we||{});function zh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:we.VERTEX|we.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:we.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:we.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function Hh({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}function Wh(s,t){const e=new Set,i=new Set,r=[...s.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),n=[...s.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return i.has(a)?!1:(i.add(a),!0)});return{structs:r,groups:n}}const Ts=Object.create(null);class is{constructor(t){var a,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:r,gpuLayout:n,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=i,e.source===i.source){const c=As(e.source);this.structsAndGroups=c}else{const c=As(i.source),l=As(e.source);this.structsAndGroups=Wh(c,l)}this.layout=r??Hh(this.structsAndGroups),this.gpuLayout=n??zh(this.structsAndGroups),this.autoAssignGlobalUniforms=((a=this.layout[0])==null?void 0:a.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=bi(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=$h(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Ts[e]||(Ts[e]=new is(t)),Ts[e]}}const eo=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],Uh=eo.reduce((s,t)=>(s[t]=!0,s),{});function Vh(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const so=class io{constructor(t,e){this._touched=0,this.uid=rt("uniform"),this._resourceType="uniformGroup",this._resourceId=rt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...io.defaultOptions,...e},this.uniformStructures=t;const i={};for(const r in t){const n=t[r];if(n.name=r,n.size=n.size??1,!Uh[n.type])throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${eo.join(", ")}`);n.value??(n.value=Vh(n.type,n.size)),i[r]=n.value}this.uniforms=i,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=bi(Object.keys(i).map(r=>`${r}-${t[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};so.defaultOptions={ubo:!1,isStatic:!1};let ro=so;class Ue{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const r=t[i];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){var r,n;const i=this.resources[e];t!==i&&(i&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){var e;const t=this.resources;for(const i in t){const r=t[i];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}var Js=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(Js||{});class wi extends Rt{constructor(t){super(),this.uid=rt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:r,resources:n,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=i,o===void 0&&(o=0,e&&(o|=Js.WEBGPU),i&&(o|=Js.WEBGL)),this.compatibleRenderers=o;const h={};if(!n&&!r&&(n={}),n&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&r&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&r&&a)for(const c in a)for(const l in a[c]){const d=a[c][l];h[d]={group:c,binding:l,name:d}}else if(e&&r&&!a){const c=e.structsAndGroups.groups;a={},c.forEach(l=>{a[l.group]=a[l.group]||{},a[l.group][l.binding]=l.name,h[l.name]=l})}else if(n){r={},a={},e&&e.structsAndGroups.groups.forEach(d=>{a[d.group]=a[d.group]||{},a[d.group][d.binding]=d.name,h[d.name]=d});let c=0;for(const l in n)h[l]||(r[99]||(r[99]=new Ue,this._ownedBindGroups.push(r[99])),h[l]={group:99,binding:c,name:l},a[99]=a[99]||{},a[99][c]=l,c++);for(const l in n){const d=l;let f=n[l];!f.source&&!f._resourceType&&(f=new ro(f));const u=h[d];u&&(r[u.group]||(r[u.group]=new Ue,this._ownedBindGroups.push(r[u.group])),r[u.group].setResource(f,u.binding))}}this.groups=r,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(r,h)}addResource(t,e,i){var r,n;(r=this._uniformBindMap)[e]||(r[e]={}),(n=this._uniformBindMap[e])[i]||(n[i]=t),this.groups[e]||(this.groups[e]=new Ue,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const r in e){const n=e[r];Object.defineProperty(i,n.name,{get(){return t[n.group].getResource(n.binding)},set(o){t[n.group].setResource(o,n.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...r}=t;let n,o;return e&&(n=is.from(e)),i&&(o=to.from(i)),new wi({gpuProgram:n,glProgram:o,...r})}}const ti=[];wt.handleByNamedList(Y.Environment,ti);async function jh(s){if(!s)for(let t=0;t<ti.length;t++){const e=ti[t];if(e.value.test()){await e.value.load();return}}}let ge;function Yh(){if(typeof ge=="boolean")return ge;try{ge=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ge=!1}return ge}var Ne={exports:{}},ur;function Xh(){if(ur)return Ne.exports;ur=1,Ne.exports=s,Ne.exports.default=s;function s(p,y,x){x=x||2;var v=y&&y.length,C=v?y[0]*x:p.length,T=t(p,0,C,x,!0),M=[];if(!T||T.next===T.prev)return M;var E,G,D,U,V,$,it;if(v&&(T=h(p,y,T,x)),p.length>80*x){E=D=p[0],G=U=p[1];for(var W=x;W<C;W+=x)V=p[W],$=p[W+1],V<E&&(E=V),$<G&&(G=$),V>D&&(D=V),$>U&&(U=$);it=Math.max(D-E,U-G),it=it!==0?32767/it:0}return i(T,M,x,E,G,it,0),M}function t(p,y,x,v,C){var T,M;if(C===Ft(p,y,x,v)>0)for(T=y;T<x;T+=v)M=K(T,p[T],p[T+1],M);else for(T=x-v;T>=y;T-=v)M=K(T,p[T],p[T+1],M);return M&&A(M,M.next)&&(X(M),M=M.next),M}function e(p,y){if(!p)return p;y||(y=p);var x=p,v;do if(v=!1,!x.steiner&&(A(x,x.next)||S(x.prev,x,x.next)===0)){if(X(x),x=y=x.prev,x===x.next)break;v=!0}else x=x.next;while(v||x!==y);return y}function i(p,y,x,v,C,T,M){if(p){!M&&T&&u(p,v,C,T);for(var E=p,G,D;p.prev!==p.next;){if(G=p.prev,D=p.next,T?n(p,v,C,T):r(p)){y.push(G.i/x|0),y.push(p.i/x|0),y.push(D.i/x|0),X(p),p=D.next,E=D.next;continue}if(p=D,p===E){M?M===1?(p=o(e(p),y,x),i(p,y,x,v,C,T,2)):M===2&&a(p,y,x,v,C,T):i(e(p),y,x,v,C,T,1);break}}}}function r(p){var y=p.prev,x=p,v=p.next;if(S(y,x,v)>=0)return!1;for(var C=y.x,T=x.x,M=v.x,E=y.y,G=x.y,D=v.y,U=C<T?C<M?C:M:T<M?T:M,V=E<G?E<D?E:D:G<D?G:D,$=C>T?C>M?C:M:T>M?T:M,it=E>G?E>D?E:D:G>D?G:D,W=v.next;W!==y;){if(W.x>=U&&W.x<=$&&W.y>=V&&W.y<=it&&b(C,E,T,G,M,D,W.x,W.y)&&S(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function n(p,y,x,v){var C=p.prev,T=p,M=p.next;if(S(C,T,M)>=0)return!1;for(var E=C.x,G=T.x,D=M.x,U=C.y,V=T.y,$=M.y,it=E<G?E<D?E:D:G<D?G:D,W=U<V?U<$?U:$:V<$?V:$,Dt=E>G?E>D?E:D:G>D?G:D,gt=U>V?U>$?U:$:V>$?V:$,Pt=_(it,W,y,x,v),It=_(Dt,gt,y,x,v),O=p.prevZ,H=p.nextZ;O&&O.z>=Pt&&H&&H.z<=It;){if(O.x>=it&&O.x<=Dt&&O.y>=W&&O.y<=gt&&O!==C&&O!==M&&b(E,U,G,V,D,$,O.x,O.y)&&S(O.prev,O,O.next)>=0||(O=O.prevZ,H.x>=it&&H.x<=Dt&&H.y>=W&&H.y<=gt&&H!==C&&H!==M&&b(E,U,G,V,D,$,H.x,H.y)&&S(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;O&&O.z>=Pt;){if(O.x>=it&&O.x<=Dt&&O.y>=W&&O.y<=gt&&O!==C&&O!==M&&b(E,U,G,V,D,$,O.x,O.y)&&S(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;H&&H.z<=It;){if(H.x>=it&&H.x<=Dt&&H.y>=W&&H.y<=gt&&H!==C&&H!==M&&b(E,U,G,V,D,$,H.x,H.y)&&S(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function o(p,y,x){var v=p;do{var C=v.prev,T=v.next.next;!A(C,T)&&k(C,v,v.next,T)&&L(C,T)&&L(T,C)&&(y.push(C.i/x|0),y.push(v.i/x|0),y.push(T.i/x|0),X(v),X(v.next),v=p=T),v=v.next}while(v!==p);return e(v)}function a(p,y,x,v,C,T){var M=p;do{for(var E=M.next.next;E!==M.prev;){if(M.i!==E.i&&w(M,E)){var G=B(M,E);M=e(M,M.next),G=e(G,G.next),i(M,y,x,v,C,T,0),i(G,y,x,v,C,T,0);return}E=E.next}M=M.next}while(M!==p)}function h(p,y,x,v){var C=[],T,M,E,G,D;for(T=0,M=y.length;T<M;T++)E=y[T]*v,G=T<M-1?y[T+1]*v:p.length,D=t(p,E,G,v,!1),D===D.next&&(D.steiner=!0),C.push(m(D));for(C.sort(c),T=0;T<C.length;T++)x=l(C[T],x);return x}function c(p,y){return p.x-y.x}function l(p,y){var x=d(p,y);if(!x)return y;var v=B(x,p);return e(v,v.next),e(x,x.next)}function d(p,y){var x=y,v=p.x,C=p.y,T=-1/0,M;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){var E=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(E<=v&&E>T&&(T=E,M=x.x<x.next.x?x:x.next,E===v))return M}x=x.next}while(x!==y);if(!M)return null;var G=M,D=M.x,U=M.y,V=1/0,$;x=M;do v>=x.x&&x.x>=D&&v!==x.x&&b(C<U?v:T,C,D,U,C<U?T:v,C,x.x,x.y)&&($=Math.abs(C-x.y)/(v-x.x),L(x,p)&&($<V||$===V&&(x.x>M.x||x.x===M.x&&f(M,x)))&&(M=x,V=$)),x=x.next;while(x!==G);return M}function f(p,y){return S(p.prev,p,y.prev)<0&&S(y.next,p,p.next)<0}function u(p,y,x,v){var C=p;do C.z===0&&(C.z=_(C.x,C.y,y,x,v)),C.prevZ=C.prev,C.nextZ=C.next,C=C.next;while(C!==p);C.prevZ.nextZ=null,C.prevZ=null,g(C)}function g(p){var y,x,v,C,T,M,E,G,D=1;do{for(x=p,p=null,T=null,M=0;x;){for(M++,v=x,E=0,y=0;y<D&&(E++,v=v.nextZ,!!v);y++);for(G=D;E>0||G>0&&v;)E!==0&&(G===0||!v||x.z<=v.z)?(C=x,x=x.nextZ,E--):(C=v,v=v.nextZ,G--),T?T.nextZ=C:p=C,C.prevZ=T,T=C;x=v}T.nextZ=null,D*=2}while(M>1);return p}function _(p,y,x,v,C){return p=(p-x)*C|0,y=(y-v)*C|0,p=(p|p<<8)&16711935,p=(p|p<<4)&252645135,p=(p|p<<2)&858993459,p=(p|p<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,p|y<<1}function m(p){var y=p,x=p;do(y.x<x.x||y.x===x.x&&y.y<x.y)&&(x=y),y=y.next;while(y!==p);return x}function b(p,y,x,v,C,T,M,E){return(C-M)*(y-E)>=(p-M)*(T-E)&&(p-M)*(v-E)>=(x-M)*(y-E)&&(x-M)*(T-E)>=(C-M)*(v-E)}function w(p,y){return p.next.i!==y.i&&p.prev.i!==y.i&&!N(p,y)&&(L(p,y)&&L(y,p)&&R(p,y)&&(S(p.prev,p,y.prev)||S(p,y.prev,y))||A(p,y)&&S(p.prev,p,p.next)>0&&S(y.prev,y,y.next)>0)}function S(p,y,x){return(y.y-p.y)*(x.x-y.x)-(y.x-p.x)*(x.y-y.y)}function A(p,y){return p.x===y.x&&p.y===y.y}function k(p,y,x,v){var C=I(S(p,y,x)),T=I(S(p,y,v)),M=I(S(x,v,p)),E=I(S(x,v,y));return!!(C!==T&&M!==E||C===0&&P(p,x,y)||T===0&&P(p,v,y)||M===0&&P(x,p,v)||E===0&&P(x,y,v))}function P(p,y,x){return y.x<=Math.max(p.x,x.x)&&y.x>=Math.min(p.x,x.x)&&y.y<=Math.max(p.y,x.y)&&y.y>=Math.min(p.y,x.y)}function I(p){return p>0?1:p<0?-1:0}function N(p,y){var x=p;do{if(x.i!==p.i&&x.next.i!==p.i&&x.i!==y.i&&x.next.i!==y.i&&k(x,x.next,p,y))return!0;x=x.next}while(x!==p);return!1}function L(p,y){return S(p.prev,p,p.next)<0?S(p,y,p.next)>=0&&S(p,p.prev,y)>=0:S(p,y,p.prev)<0||S(p,p.next,y)<0}function R(p,y){var x=p,v=!1,C=(p.x+y.x)/2,T=(p.y+y.y)/2;do x.y>T!=x.next.y>T&&x.next.y!==x.y&&C<(x.next.x-x.x)*(T-x.y)/(x.next.y-x.y)+x.x&&(v=!v),x=x.next;while(x!==p);return v}function B(p,y){var x=new ot(p.i,p.x,p.y),v=new ot(y.i,y.x,y.y),C=p.next,T=y.prev;return p.next=y,y.prev=p,x.next=C,C.prev=x,v.next=x,x.prev=v,T.next=v,v.prev=T,v}function K(p,y,x,v){var C=new ot(p,y,x);return v?(C.next=v.next,C.prev=v,v.next.prev=C,v.next=C):(C.prev=C,C.next=C),C}function X(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function ot(p,y,x){this.i=p,this.x=y,this.y=x,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}s.deviation=function(p,y,x,v){var C=y&&y.length,T=C?y[0]*x:p.length,M=Math.abs(Ft(p,0,T,x));if(C)for(var E=0,G=y.length;E<G;E++){var D=y[E]*x,U=E<G-1?y[E+1]*x:p.length;M-=Math.abs(Ft(p,D,U,x))}var V=0;for(E=0;E<v.length;E+=3){var $=v[E]*x,it=v[E+1]*x,W=v[E+2]*x;V+=Math.abs((p[$]-p[W])*(p[it+1]-p[$+1])-(p[$]-p[it])*(p[W+1]-p[$+1]))}return M===0&&V===0?0:Math.abs((V-M)/M)};function Ft(p,y,x,v){for(var C=0,T=y,M=x-v;T<x;T+=v)C+=(p[M]-p[T])*(p[T+1]+p[M+1]),M=T;return C}return s.flatten=function(p){for(var y=p[0][0].length,x={vertices:[],holes:[],dimensions:y},v=0,C=0;C<p.length;C++){for(var T=0;T<p[C].length;T++)for(var M=0;M<y;M++)x.vertices.push(p[C][T][M]);C>0&&(v+=p[C-1].length,x.holes.push(v))}return x},Ne.exports}var qh=Xh();const Kh=mi(qh);var no=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(no||{});class Zh{constructor(t){this.items=[],this._name=t}emit(t,e,i,r,n,o,a,h){const{name:c,items:l}=this;for(let d=0,f=l.length;d<f;d++)l[d][c](t,e,i,r,n,o,a,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Qh=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],oo=class ao extends Rt{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Qh,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await jh(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)t={...this._systemsHash[i].constructor.defaultOptions,...t};t={...ao.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(t);this._initOptions=t}render(t,e){let i=t;if(i instanceof J&&(i={container:i},e&&(q(et,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const r=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=r?i.clearColor:ut.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){const r=this.view.resolution;this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),i!==void 0&&i!==r&&this.runners.resolutionChange.emit(i)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=no.ALL);const{clear:i,clearColor:r,target:n}=t;ut.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(n,i,ut.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Zh(e)})}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const r in this.runners)this.runners[r].add(i);return this}_addPipes(t,e){const i=e.reduce((r,n)=>(r[n.name]=n.value,r),{});t.forEach(r=>{const n=r.value,o=r.name,a=i[o];this.renderPipes[o]=new n(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Yh())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};oo.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let ho=oo,Oe;function Jh(s){return Oe!==void 0||(Oe=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??ho.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Ct.get().getWebGLRenderingContext())return!1;let r=Ct.get().createCanvas().getContext("webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}})()),Oe}let $e;async function tc(s={}){return $e!==void 0||($e=await(async()=>{const t=Ct.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),$e}const dr=["webgl","webgpu","canvas"];async function ec(s){let t=[];s.preference?(t.push(s.preference),dr.forEach(n=>{n!==s.preference&&t.push(n)})):t=dr.slice();let e,i={};for(let n=0;n<t.length;n++){const o=t[n];if(o==="webgpu"&&await tc()){const{WebGPURenderer:a}=await je(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-Cq185Bfw.js");return{WebGPURenderer:h}},__vite__mapDeps([4,2,5,3]),import.meta.url);e=a,i={...s,...s.webgpu};break}else if(o==="webgl"&&Jh(s.failIfMajorPerformanceCaveat??ho.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await je(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-oNX7jt-i.js");return{WebGLRenderer:h}},__vite__mapDeps([6,2,5]),import.meta.url);e=a,i={...s,...s.webgl};break}else if(o==="canvas")throw i={...s},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!e)throw new Error("No available renderer for the current environment");const r=new e;return await r.init(i),r}const co="8.9.1";class lo{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,co)}static destroy(){}}lo.extension=Y.Application;class sc{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,co)}destroy(){this._renderer=null}}sc.extension={type:[Y.WebGLSystem,Y.WebGPUSystem],name:"initHook",priority:-10};const uo=class ei{constructor(...t){this.stage=new J,t[0]!==void 0&&q(et,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await ec(t),ei._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return q(et,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const i=ei._plugins.slice(0);i.reverse(),i.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};uo._plugins=[];let fo=uo;wt.handleByList(Y.Application,fo._plugins);wt.add(lo);const fr=[{offset:0,color:"white"},{offset:1,color:"black"}],Si=class si{constructor(...t){this.uid=rt("fillGradient"),this.type="linear",this.colorStops=[];let e=ic(t);e={...e.type==="radial"?si.defaultRadialOptions:si.defaultLinearOptions,...Sn(e)},this._textureSize=e.textureSize,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:ut.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:fr,e=this._textureSize,{canvas:i,context:r}=mr(e,1),n=r.createLinearGradient(0,0,this._textureSize,0);pr(n,t),r.fillStyle=n,r.fillRect(0,0,e,1),this.texture=new j({source:new Ye({resource:i})});const{x:o,y:a}=this.start,{x:h,y:c}=this.end,l=new z,d=h-o,f=c-a,u=Math.sqrt(d*d+f*f),g=Math.atan2(f,d);l.scale(u/e,1),l.rotate(g),l.translate(o,a),this.textureSpace==="local"&&l.scale(e,e),this.transform=l}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:fr,e=this._textureSize,{canvas:i,context:r}=mr(e,e),{x:n,y:o}=this.center,{x:a,y:h}=this.outerCenter,c=this.innerRadius,l=this.outerRadius,d=a-l,f=h-l,u=e/(l*2),g=(n-d)*u,_=(o-f)*u,m=r.createRadialGradient(g,_,c*u,(a-d)*u,(h-f)*u,l*u);pr(m,t),r.fillStyle=t[t.length-1].color,r.fillRect(0,0,e,e),r.fillStyle=m,r.translate(g,_),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-g,-_),r.fillRect(0,0,e,e),this.texture=new j({source:new Ye({resource:i,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const b=new z;b.scale(1/u,1/u),b.translate(d,f),this.textureSpace==="local"&&b.scale(e,e),this.transform=b}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};Si.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};Si.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let se=Si;function pr(s,t){for(let e=0;e<t.length;e++){const i=t[e];s.addColorStop(i.offset,i.color)}}function mr(s,t){const e=Ct.get().createCanvas(s,t),i=e.getContext("2d");return{canvas:e,context:i}}function ic(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(q("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??se.defaultLinearOptions.textureSize}),t}const gr={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class vi{constructor(t,e){this.uid=rt("fillPattern"),this.transform=new z,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=gr[e].addressModeU,t.source.style.addressModeV=gr[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Ms,yr;function rc(){if(yr)return Ms;yr=1,Ms=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var o=[];return n.replace(t,function(a,h,c){var l=h.toLowerCase();for(c=r(c),l=="m"&&c.length>2&&(o.push([h].concat(c.splice(0,2))),l="l",h=h=="m"?"l":"L");;){if(c.length==s[l])return c.unshift(h),o.push(c);if(c.length<s[l])throw new Error("malformed path data");o.push([h].concat(c.splice(0,s[l])))}}),o}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(n){var o=n.match(i);return o?o.map(Number):[]}return Ms}var nc=rc();const oc=mi(nc);function ac(s,t){const e=oc(s),i=[];let r=null,n=0,o=0;for(let a=0;a<e.length;a++){const h=e[a],c=h[0],l=h;switch(c){case"M":n=l[1],o=l[2],t.moveTo(n,o);break;case"m":n+=l[1],o+=l[2],t.moveTo(n,o);break;case"H":n=l[1],t.lineTo(n,o);break;case"h":n+=l[1],t.lineTo(n,o);break;case"V":o=l[1],t.lineTo(n,o);break;case"v":o+=l[1],t.lineTo(n,o);break;case"L":n=l[1],o=l[2],t.lineTo(n,o);break;case"l":n+=l[1],o+=l[2],t.lineTo(n,o);break;case"C":n=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],n,o);break;case"c":t.bezierCurveTo(n+l[1],o+l[2],n+l[3],o+l[4],n+l[5],o+l[6]),n+=l[5],o+=l[6];break;case"S":n=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],n,o);break;case"s":t.bezierCurveToShort(n+l[1],o+l[2],n+l[3],o+l[4]),n+=l[3],o+=l[4];break;case"Q":n=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],n,o);break;case"q":t.quadraticCurveTo(n+l[1],o+l[2],n+l[3],o+l[4]),n+=l[3],o+=l[4];break;case"T":n=l[1],o=l[2],t.quadraticCurveToShort(n,o);break;case"t":n+=l[1],o+=l[2],t.quadraticCurveToShort(n,o);break;case"A":n=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,o);break;case"a":n+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,o);break;case"Z":case"z":t.closePath(),i.length>0&&(r=i.pop(),r?(n=r.startX,o=r.startY):(n=0,o=0)),r=null;break;default:xt(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&r===null&&(r={startX:n,startY:o},i.push(r))}return t}class Ci{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new Ci(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}strokeContains(t,e,i,r=.5){if(this.radius===0)return!1;const n=this.x-t,o=this.y-e,a=this.radius,h=(1-r)*i,c=Math.sqrt(n*n+o*o);return c<=a+h&&c>a-(i-h)}getBounds(t){return t||(t=new ht),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ai{constructor(t=0,e=0,i=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=r}clone(){return new Ai(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return i*=i,r*=r,i+r<=1}strokeContains(t,e,i,r=.5){const{halfWidth:n,halfHeight:o}=this;if(n<=0||o<=0)return!1;const a=i*(1-r),h=i-a,c=n-h,l=o-h,d=n+a,f=o+a,u=t-this.x,g=e-this.y,_=u*u/(c*c)+g*g/(l*l),m=u*u/(d*d)+g*g/(f*f);return _>1&&m<=1}getBounds(t){return t||(t=new ht),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function hc(s,t,e,i,r,n){const o=s-e,a=t-i,h=r-e,c=n-i,l=o*h+a*c,d=h*h+c*c;let f=-1;d!==0&&(f=l/d);let u,g;f<0?(u=e,g=i):f>1?(u=r,g=n):(u=e+f*h,g=i+f*c);const _=s-u,m=t-g;return _*_+m*m}let cc,lc;class ve{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,i=e.length;for(let r=0;r<i;r+=2){const n=e[r],o=e[r+1],a=e[(r+2)%i],h=e[(r+3)%i];t+=(a-n)*(h+o)}return t<0}containsPolygon(t){const e=this.getBounds(cc),i=t.getBounds(lc);if(!e.containsRect(i))return!1;const r=t.points;for(let n=0;n<r.length;n+=2){const o=r[n],a=r[n+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new ve(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],c=this.points[o*2],l=this.points[o*2+1];h>e!=l>e&&t<(c-a)*((e-h)/(l-h))+a&&(i=!i)}return i}strokeContains(t,e,i,r=.5){const n=i*i,o=n*(1-r),a=n-o,{points:h}=this,c=h.length-(this.closePath?0:2);for(let l=0;l<c;l+=2){const d=h[l],f=h[l+1],u=h[(l+2)%h.length],g=h[(l+3)%h.length],_=hc(t,e,d,f,u,g),m=Math.sign((u-d)*(e-f)-(g-f)*(t-d));if(_<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new ht);const e=this.points;let i=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const c=e[a],l=e[a+1];i=c<i?c:i,r=c>r?c:r,n=l<n?l:n,o=l>o?l:o}return t.x=i,t.width=r-i,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const ze=(s,t,e,i,r,n,o)=>{const a=s-e,h=t-i,c=Math.sqrt(a*a+h*h);return c>=r-n&&c<=r+o};class Ti{constructor(t=0,e=0,i=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n}getBounds(t){return t||(t=new ht),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Ti(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=e-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}strokeContains(t,e,i,r=.5){const{x:n,y:o,width:a,height:h,radius:c}=this,l=i*(1-r),d=i-l,f=n+c,u=o+c,g=a-c*2,_=h-c*2,m=n+a,b=o+h;return(t>=n-l&&t<=n+d||t>=m-d&&t<=m+l)&&e>=u&&e<=u+_||(e>=o-l&&e<=o+d||e>=b-d&&e<=b+l)&&t>=f&&t<=f+g?!0:t<f&&e<u&&ze(t,e,f,u,c,d,l)||t>m-c&&e<u&&ze(t,e,m-c,u,c,d,l)||t>m-c&&e>b-c&&ze(t,e,m-c,b-c,c,d,l)||t<f&&e>b-c&&ze(t,e,f,b-c,c,d,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const uc=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function dc(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function fc(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const i=uc.replace(/%forloop%/gi,dc(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let he=null;function po(){var t;if(he)return he;const s=Qn();return he=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),he=fc(he,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),he}const mo={};function pc(s,t){let e=2166136261;for(let i=0;i<t;i++)e^=s[i].uid,e=Math.imul(e,16777619),e>>>=0;return mo[e]||mc(s,t,e)}let Ps=0;function mc(s,t,e){const i={};let r=0;Ps||(Ps=po());for(let o=0;o<Ps;o++){const a=o<t?s[o]:j.EMPTY.source;i[r++]=a.source,i[r++]=a.style}const n=new Ue(i);return mo[e]=n,n}class xr{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function _r(s,t){const e=s.byteLength/8|0,i=new Float64Array(s,0,e);new Float64Array(t,0,e).set(i);const n=s.byteLength-e*8;if(n>0){const o=new Uint8Array(s,e*8,n);new Uint8Array(t,e*8,n).set(o)}}const gc={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var yc=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(yc||{});function br(s,t){return t.alphaMode==="no-premultiply-alpha"&&gc[s]||s}class xc{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class _c{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new xc,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const go=[];let ii=0;function wr(){return ii>0?go[--ii]:new _c}function Sr(s){go[ii++]=s}let ye=0;const yo=class Ve{constructor(t={}){this.uid=rt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Ve.defaultOptions.maxTextures=Ve.defaultOptions.maxTextures??po(),t={...Ve.defaultOptions,...t};const{maxTextures:e,attributesInitialSize:i,indicesInitialSize:r}=t;this.attributeBuffer=new xr(i*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Sr(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=wr(),r=i.textures;r.clear();const n=e[this.elementStart];let o=br(n.blendMode,n.texture._source),a=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,l=this.indexBuffer;let d=this._batchIndexSize,f=this._batchIndexStart,u="startBatch";const g=this.maxTextures;for(let _=this.elementStart;_<this.elementSize;++_){const m=e[_];e[_]=null;const w=m.texture._source,S=br(m.blendMode,w),A=o!==S||a!==m.topology;if(w._batchTick===ye&&!A){m._textureId=w._textureBindLocation,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,c,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,c,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=i;continue}w._batchTick=ye,(r.count>=g||A)&&(this._finishBatch(i,f,d-f,r,o,a,t,u),u="renderBatch",f=d,o=S,a=m.topology,i=wr(),r=i.textures,r.clear(),++ye),m._textureId=w._textureBindLocation=r.count,r.ids[w.uid]=r.count,r.textures[r.count++]=w,m._batch=i,d+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,h,c,m._attributeStart,m._textureId),this.packQuadIndex(l,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,h,c,m._attributeStart,m._textureId),this.packIndex(m,l,m._indexStart,m._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(i,f,d-f,r,o,a,t,u),f=d,++ye),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=d}_finishBatch(t,e,i,r,n,o,a,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=r,t.blendMode=n,t.topology=o,t.start=e,t.size=i,++ye,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new xr(e);_r(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const r=i>65535?new Uint32Array(i):new Uint16Array(i);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)r[n]=e[n];else _r(e.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,r){const n=t.indices,o=t.indexSize,a=t.indexOffset,h=t.attributeOffset;for(let c=0;c<o;c++)e[i++]=r+n[c+a]-h}destroy(){for(let t=0;t<this.batches.length;t++)Sr(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};yo.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let bc=yo;var pt=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(pt||{});class Pe extends Rt{constructor(t){let{data:e,size:i}=t;const{usage:r,label:n,shrinkToFit:o}=t;super(),this.uid=rt("buffer"),this._resourceType="buffer",this._resourceId=rt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i??(i=e==null?void 0:e.byteLength);const a=!!e;this.descriptor={size:i,usage:r,mappedAtCreation:a,label:n},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&pt.STATIC)}set static(t){t?this.descriptor.usage|=pt.STATIC:this.descriptor.usage&=~pt.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const r=this._data;if(this._data=t,this._dataInt32=null,!r||r.length!==t.length){!this.shrinkToFit&&r&&t.byteLength<r.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=rt("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function xo(s,t){if(!(s instanceof Pe)){let e=t?pt.INDEX:pt.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=pt.INDEX|pt.COPY_DST):(s=new Float32Array(s),e=pt.VERTEX|pt.COPY_DST)),s=new Pe({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function wc(s,t,e){const i=s.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=i.buffer.data;let n=1/0,o=1/0,a=-1/0,h=-1/0;const c=r.BYTES_PER_ELEMENT,l=(i.offset||0)/c,d=(i.stride||2*4)/c;for(let f=l;f<r.length;f+=d){const u=r[f],g=r[f+1];u>a&&(a=u),g>h&&(h=g),u<n&&(n=u),g<o&&(o=g)}return e.minX=n,e.minY=o,e.maxX=a,e.maxY=h,e}function Sc(s){return(s instanceof Pe||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=xo(s.buffer,!1),s}class vc extends Rt{constructor(t={}){super(),this.uid=rt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new At,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:r}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=Sc(e);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=xo(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,wc(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Cc=new Float32Array(1),Ac=new Uint32Array(1);class Tc extends vc{constructor(){const e=new Pe({data:Cc,label:"attribute-batch-buffer",usage:pt.VERTEX|pt.COPY_DST,shrinkToFit:!1}),i=new Pe({data:Ac,label:"index-batch-buffer",usage:pt.INDEX|pt.COPY_DST,shrinkToFit:!1}),r=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:5*4}},indexBuffer:i})}}function vr(s,t,e){if(s)for(const i in s){const r=i.toLocaleLowerCase(),n=t[r];if(n){let o=s[i];i==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(o)}else xt(`${i} placement hook does not exist in shader`)}}const Mc=/\{\{(.*?)\}\}/g;function Cr(s){var i;const t={};return(((i=s.match(Mc))==null?void 0:i.map(r=>r.replace(/[{()}]/g,"")))??[]).forEach(r=>{t[r]=[]}),t}function Ar(s,t){let e;const i=/@in\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function Tr(s,t,e=!1){const i=[];Ar(t,i),s.forEach(a=>{a.header&&Ar(a.header,i)});const r=i;e&&r.sort();const n=r.map((a,h)=>`       @location(${h}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${n}
`),o}function Mr(s,t){let e;const i=/@out\s+([^;]+);/g;for(;(e=i.exec(s))!==null;)t.push(e[1])}function Pc(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function Ic(s){const t=/@.*?\s+/g;return s.replace(t,"")}function Ec(s,t){const e=[];Mr(t,e),s.forEach(h=>{h.header&&Mr(h.header,e)});let i=0;const r=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${i++}) ${h}`).join(`,
`),n=e.sort().map(h=>`       var ${Ic(h)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(h=>` ${Pc(h)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${r}
`),a=a.replace("{{start}}",`
${n}
`),a=a.replace("{{return}}",`
${o}
`),a}function Pr(s,t){let e=s;for(const i in t){const r=t[i];r.join(`
`).length?e=e.replace(`{{${i}}}`,`//-----${i} START-----//
${r.join(`
`)}
//----${i} FINISH----//`):e=e.replace(`{{${i}}}`,"")}return e}const zt=Object.create(null),Is=new Map;let kc=0;function Rc({template:s,bits:t}){const e=_o(s,t);if(zt[e])return zt[e];const{vertex:i,fragment:r}=Fc(s,t);return zt[e]=bo(i,r,t),zt[e]}function Bc({template:s,bits:t}){const e=_o(s,t);return zt[e]||(zt[e]=bo(s.vertex,s.fragment,t)),zt[e]}function Fc(s,t){const e=t.map(o=>o.vertex).filter(o=>!!o),i=t.map(o=>o.fragment).filter(o=>!!o);let r=Tr(e,s.vertex,!0);r=Ec(e,r);const n=Tr(i,s.fragment,!0);return{vertex:r,fragment:n}}function _o(s,t){return t.map(e=>(Is.has(e)||Is.set(e,kc++),Is.get(e))).sort((e,i)=>e-i).join("-")+s.vertex+s.fragment}function bo(s,t,e){const i=Cr(s),r=Cr(t);return e.forEach(n=>{vr(n.vertex,i,n.name),vr(n.fragment,r,n.name)}),{vertex:Pr(s,i),fragment:Pr(t,r)}}const Dc=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Gc=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Lc=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,Nc=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,Oc={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},$c={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function zc({bits:s,name:t}){const e=Rc({template:{fragment:Gc,vertex:Dc},bits:[Oc,...s]});return is.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function Hc({bits:s,name:t}){return new to({name:t,...Bc({template:{vertex:Lc,fragment:Nc},bits:[$c,...s]})})}const Wc={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Uc={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Es={};function Vc(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let i=0;i<s;i++)t.push(`@group(1) @binding(${e++}) var textureSource${i+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${i+1}: sampler;`)}return t.join(`
`)}function jc(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Yc(s){return Es[s]||(Es[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Vc(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${jc(s)}
            `}}),Es[s]}const ks={};function Xc(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function qc(s){return ks[s]||(ks[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${Xc(s)}
            `}}),ks[s]}const Kc={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Zc={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Ir={};function Qc(s){let t=Ir[s];if(t)return t;const e=new Int32Array(s);for(let i=0;i<s;i++)e[i]=i;return t=Ir[s]=new ro({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class Jc extends wi{constructor(t){const e=Hc({name:"batch",bits:[Uc,qc(t),Zc]}),i=zc({name:"batch",bits:[Wc,Yc(t),Kc]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:Qc(t)}})}}let Er=null;const wo=class So extends bc{constructor(){super(...arguments),this.geometry=new Tc,this.shader=Er||(Er=new Jc(this.maxTextures)),this.name=So.extension.name,this.vertexSize=6}packAttributes(t,e,i,r,n){const o=n<<16|t.roundPixels&65535,a=t.transform,h=a.a,c=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,{positions:g,uvs:_}=t,m=t.color,b=t.attributeOffset,w=b+t.attributeSize;for(let S=b;S<w;S++){const A=S*2,k=g[A],P=g[A+1];e[r++]=h*k+l*P+f,e[r++]=d*P+c*k+u,e[r++]=_[A],e[r++]=_[A+1],i[r++]=m,i[r++]=o}}packQuadAttributes(t,e,i,r,n){const o=t.texture,a=t.transform,h=a.a,c=a.b,l=a.c,d=a.d,f=a.tx,u=a.ty,g=t.bounds,_=g.maxX,m=g.minX,b=g.maxY,w=g.minY,S=o.uvs,A=t.color,k=n<<16|t.roundPixels&65535;e[r+0]=h*m+l*w+f,e[r+1]=d*w+c*m+u,e[r+2]=S.x0,e[r+3]=S.y0,i[r+4]=A,i[r+5]=k,e[r+6]=h*_+l*w+f,e[r+7]=d*w+c*_+u,e[r+8]=S.x1,e[r+9]=S.y1,i[r+10]=A,i[r+11]=k,e[r+12]=h*_+l*b+f,e[r+13]=d*b+c*_+u,e[r+14]=S.x2,e[r+15]=S.y2,i[r+16]=A,i[r+17]=k,e[r+18]=h*m+l*b+f,e[r+19]=d*b+c*m+u,e[r+20]=S.x3,e[r+21]=S.y3,i[r+22]=A,i[r+23]=k}};wo.extension={type:[Y.Batcher],name:"default"};let tl=wo;function el(s,t,e,i,r,n,o,a=null){let h=0;e*=t,r*=n;const c=a.a,l=a.b,d=a.c,f=a.d,u=a.tx,g=a.ty;for(;h<o;){const _=s[e],m=s[e+1];i[r]=c*_+d*m+u,i[r+1]=l*_+f*m+g,r+=n,e+=t,h++}}function sl(s,t,e,i){let r=0;for(t*=e;r<i;)s[t]=0,s[t+1]=0,t+=e,r++}function vo(s,t,e,i,r){const n=t.a,o=t.b,a=t.c,h=t.d,c=t.tx,l=t.ty;e||(e=0),i||(i=2),r||(r=s.length/i-e);let d=e*i;for(let f=0;f<r;f++){const u=s[d],g=s[d+1];s[d]=n*u+a*g+c,s[d+1]=o*u+h*g+l,d+=i}}const il=new z;class Co{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,i=this.renderable;return i?Rn(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||il}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Ie={extension:{type:Y.ShapeBuilder,name:"circle"},build(s,t){let e,i,r,n,o,a;if(s.type==="circle"){const A=s;e=A.x,i=A.y,o=a=A.radius,r=n=0}else if(s.type==="ellipse"){const A=s;e=A.x,i=A.y,o=A.halfWidth,a=A.halfHeight,r=n=0}else{const A=s,k=A.width/2,P=A.height/2;e=A.x+k,i=A.y+P,o=a=Math.max(0,Math.min(A.radius,Math.min(k,P))),r=k-o,n=P-a}if(!(o>=0&&a>=0&&r>=0&&n>=0))return t;const h=Math.ceil(2.3*Math.sqrt(o+a)),c=h*8+(r?4:0)+(n?4:0);if(c===0)return t;if(h===0)return t[0]=t[6]=e+r,t[1]=t[3]=i+n,t[2]=t[4]=e-r,t[5]=t[7]=i-n,t;let l=0,d=h*4+(r?2:0)+2,f=d,u=c,g=r+o,_=n,m=e+g,b=e-g,w=i+_;if(t[l++]=m,t[l++]=w,t[--d]=w,t[--d]=b,n){const A=i-_;t[f++]=b,t[f++]=A,t[--u]=A,t[--u]=m}for(let A=1;A<h;A++){const k=Math.PI/2*(A/h),P=r+Math.cos(k)*o,I=n+Math.sin(k)*a,N=e+P,L=e-P,R=i+I,B=i-I;t[l++]=N,t[l++]=R,t[--d]=R,t[--d]=L,t[f++]=L,t[f++]=B,t[--u]=B,t[--u]=N}g=r,_=n+a,m=e+g,b=e-g,w=i+_;const S=i-_;return t[l++]=m,t[l++]=w,t[--u]=S,t[--u]=m,r&&(t[l++]=b,t[l++]=w,t[--u]=S,t[--u]=b),t},triangulate(s,t,e,i,r,n){if(s.length===0)return;let o=0,a=0;for(let l=0;l<s.length;l+=2)o+=s[l],a+=s[l+1];o/=s.length/2,a/=s.length/2;let h=i;t[h*e]=o,t[h*e+1]=a;const c=h++;for(let l=0;l<s.length;l+=2)t[h*e]=s[l],t[h*e+1]=s[l+1],l>0&&(r[n++]=h,r[n++]=c,r[n++]=h-1),h++;r[n++]=c+1,r[n++]=c,r[n++]=h-1}},rl={...Ie,extension:{...Ie.extension,name:"ellipse"}},nl={...Ie,extension:{...Ie.extension,name:"roundedRectangle"}},Ao=1e-4,kr=1e-4;function ol(s){const t=s.length;if(t<6)return 1;let e=0;for(let i=0,r=s[t-2],n=s[t-1];i<t;i+=2){const o=s[i],a=s[i+1];e+=(o-r)*(a+n),r=o,n=a}return e<0?-1:1}function Rr(s,t,e,i,r,n,o,a){const h=s-e*r,c=t-i*r,l=s+e*n,d=t+i*n;let f,u;o?(f=i,u=-e):(f=-i,u=e);const g=h+f,_=c+u,m=l+f,b=d+u;return a.push(g,_),a.push(m,b),2}function jt(s,t,e,i,r,n,o,a){const h=e-s,c=i-t;let l=Math.atan2(h,c),d=Math.atan2(r-s,n-t);a&&l<d?l+=Math.PI*2:!a&&l>d&&(d+=Math.PI*2);let f=l;const u=d-l,g=Math.abs(u),_=Math.sqrt(h*h+c*c),m=(15*g*Math.sqrt(_)/Math.PI>>0)+1,b=u/m;if(f+=b,a){o.push(s,t),o.push(e,i);for(let w=1,S=f;w<m;w++,S+=b)o.push(s,t),o.push(s+Math.sin(S)*_,t+Math.cos(S)*_);o.push(s,t),o.push(r,n)}else{o.push(e,i),o.push(s,t);for(let w=1,S=f;w<m;w++,S+=b)o.push(s+Math.sin(S)*_,t+Math.cos(S)*_),o.push(s,t);o.push(r,n),o.push(s,t)}return m*2}function al(s,t,e,i,r,n){const o=Ao;if(s.length===0)return;const a=t;let h=a.alignment;if(t.alignment!==.5){let v=ol(s);h=(h-.5)*v+.5}const c=new lt(s[0],s[1]),l=new lt(s[s.length-2],s[s.length-1]),d=i,f=Math.abs(c.x-l.x)<o&&Math.abs(c.y-l.y)<o;if(d){s=s.slice(),f&&(s.pop(),s.pop(),l.set(s[s.length-2],s[s.length-1]));const v=(c.x+l.x)*.5,C=(l.y+c.y)*.5;s.unshift(v,C),s.push(v,C)}const u=r,g=s.length/2;let _=s.length;const m=u.length/2,b=a.width/2,w=b*b,S=a.miterLimit*a.miterLimit;let A=s[0],k=s[1],P=s[2],I=s[3],N=0,L=0,R=-(k-I),B=A-P,K=0,X=0,ot=Math.sqrt(R*R+B*B);R/=ot,B/=ot,R*=b,B*=b;const Ft=h,p=(1-Ft)*2,y=Ft*2;d||(a.cap==="round"?_+=jt(A-R*(p-y)*.5,k-B*(p-y)*.5,A-R*p,k-B*p,A+R*y,k+B*y,u,!0)+2:a.cap==="square"&&(_+=Rr(A,k,R,B,p,y,!0,u))),u.push(A-R*p,k-B*p),u.push(A+R*y,k+B*y);for(let v=1;v<g-1;++v){A=s[(v-1)*2],k=s[(v-1)*2+1],P=s[v*2],I=s[v*2+1],N=s[(v+1)*2],L=s[(v+1)*2+1],R=-(k-I),B=A-P,ot=Math.sqrt(R*R+B*B),R/=ot,B/=ot,R*=b,B*=b,K=-(I-L),X=P-N,ot=Math.sqrt(K*K+X*X),K/=ot,X/=ot,K*=b,X*=b;const C=P-A,T=k-I,M=P-N,E=L-I,G=C*M+T*E,D=T*M-E*C,U=D<0;if(Math.abs(D)<.001*Math.abs(G)){u.push(P-R*p,I-B*p),u.push(P+R*y,I+B*y),G>=0&&(a.join==="round"?_+=jt(P,I,P-R*p,I-B*p,P-K*p,I-X*p,u,!1)+4:_+=2,u.push(P-K*y,I-X*y),u.push(P+K*p,I+X*p));continue}const V=(-R+A)*(-B+I)-(-R+P)*(-B+k),$=(-K+N)*(-X+I)-(-K+P)*(-X+L),it=(C*$-M*V)/D,W=(E*V-T*$)/D,Dt=(it-P)*(it-P)+(W-I)*(W-I),gt=P+(it-P)*p,Pt=I+(W-I)*p,It=P-(it-P)*y,O=I-(W-I)*y,H=Math.min(C*C+T*T,M*M+E*E),Ni=U?p:y,ya=H+Ni*Ni*w;Dt<=ya?a.join==="bevel"||Dt/w>S?(U?(u.push(gt,Pt),u.push(P+R*y,I+B*y),u.push(gt,Pt),u.push(P+K*y,I+X*y)):(u.push(P-R*p,I-B*p),u.push(It,O),u.push(P-K*p,I-X*p),u.push(It,O)),_+=2):a.join==="round"?U?(u.push(gt,Pt),u.push(P+R*y,I+B*y),_+=jt(P,I,P+R*y,I+B*y,P+K*y,I+X*y,u,!0)+4,u.push(gt,Pt),u.push(P+K*y,I+X*y)):(u.push(P-R*p,I-B*p),u.push(It,O),_+=jt(P,I,P-R*p,I-B*p,P-K*p,I-X*p,u,!1)+4,u.push(P-K*p,I-X*p),u.push(It,O)):(u.push(gt,Pt),u.push(It,O)):(u.push(P-R*p,I-B*p),u.push(P+R*y,I+B*y),a.join==="round"?U?_+=jt(P,I,P+R*y,I+B*y,P+K*y,I+X*y,u,!0)+2:_+=jt(P,I,P-R*p,I-B*p,P-K*p,I-X*p,u,!1)+2:a.join==="miter"&&Dt/w<=S&&(U?(u.push(It,O),u.push(It,O)):(u.push(gt,Pt),u.push(gt,Pt)),_+=2),u.push(P-K*p,I-X*p),u.push(P+K*y,I+X*y),_+=2)}A=s[(g-2)*2],k=s[(g-2)*2+1],P=s[(g-1)*2],I=s[(g-1)*2+1],R=-(k-I),B=A-P,ot=Math.sqrt(R*R+B*B),R/=ot,B/=ot,R*=b,B*=b,u.push(P-R*p,I-B*p),u.push(P+R*y,I+B*y),d||(a.cap==="round"?_+=jt(P-R*(p-y)*.5,I-B*(p-y)*.5,P-R*p,I-B*p,P+R*y,I+B*y,u,!1)+2:a.cap==="square"&&(_+=Rr(P,I,R,B,p,y,!1,u)));const x=kr*kr;for(let v=m;v<_+m-2;++v)A=u[v*2],k=u[v*2+1],P=u[(v+1)*2],I=u[(v+1)*2+1],N=u[(v+2)*2],L=u[(v+2)*2+1],!(Math.abs(A*(I-L)+P*(L-k)+N*(k-I))<x)&&n.push(v,v+1,v+2)}function hl(s,t,e,i){const r=Ao;if(s.length===0)return;const n=s[0],o=s[1],a=s[s.length-2],h=s[s.length-1],c=t||Math.abs(n-a)<r&&Math.abs(o-h)<r,l=e,d=s.length/2,f=l.length/2;for(let u=0;u<d;u++)l.push(s[u*2]),l.push(s[u*2+1]);for(let u=0;u<d-1;u++)i.push(f+u,f+u+1);c&&i.push(f+d-1,f)}function To(s,t,e,i,r,n,o){const a=Kh(s,t,2);if(!a)return;for(let c=0;c<a.length;c+=3)n[o++]=a[c]+r,n[o++]=a[c+1]+r,n[o++]=a[c+2]+r;let h=r*i;for(let c=0;c<s.length;c+=2)e[h]=s[c],e[h+1]=s[c+1],h+=i}const cl=[],ll={extension:{type:Y.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return t},triangulate(s,t,e,i,r,n){To(s,cl,t,e,i,r,n)}},ul={extension:{type:Y.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,i=e.x,r=e.y,n=e.width,o=e.height;return n>=0&&o>=0&&(t[0]=i,t[1]=r,t[2]=i+n,t[3]=r,t[4]=i+n,t[5]=r+o,t[6]=i,t[7]=r+o),t},triangulate(s,t,e,i,r,n){let o=0;i*=e,t[i+o]=s[0],t[i+o+1]=s[1],o+=e,t[i+o]=s[2],t[i+o+1]=s[3],o+=e,t[i+o]=s[6],t[i+o+1]=s[7],o+=e,t[i+o]=s[4],t[i+o+1]=s[5],o+=e;const a=i/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2,r[n++]=a+1,r[n++]=a+3,r[n++]=a+2}},dl={extension:{type:Y.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,t},triangulate(s,t,e,i,r,n){let o=0;i*=e,t[i+o]=s[0],t[i+o+1]=s[1],o+=e,t[i+o]=s[2],t[i+o+1]=s[3],o+=e,t[i+o]=s[4],t[i+o+1]=s[5];const a=i/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2}},fl=new z,pl=new ht;function ml(s,t,e,i){const r=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const n=e.getBounds(pl);r.translate(-n.x,-n.y),r.scale(1/n.width,1/n.height)}else{r.translate(t.texture.frame.x,t.texture.frame.y),r.scale(1/t.texture.source.width,1/t.texture.source.height);const n=t.texture.source.style;n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update())}return i&&r.append(fl.copyFrom(i).invert()),r}const rs={};wt.handleByMap(Y.ShapeBuilder,rs);wt.add(ul,ll,dl,Ie,rl,nl);const gl=new ht,yl=new z;function xl(s,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<s.instructions.length;r++){const n=s.instructions[r];if(n.action==="texture")_l(n.data,i,e);else if(n.action==="fill"||n.action==="stroke"){const o=n.action==="stroke",a=n.data.path.shapePath,h=n.data.style,c=n.data.hole;o&&c&&Br(c.shapePath,h,!0,i,e),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Br(a,h,o,i,e)}}}function _l(s,t,e){const{vertices:i,uvs:r,indices:n}=e,o=n.length,a=i.length/2,h=[],c=rs.rectangle,l=gl,d=s.image;l.x=s.dx,l.y=s.dy,l.width=s.dw,l.height=s.dh;const f=s.transform;c.build(l,h),f&&vo(h,f),c.triangulate(h,i,2,a,n,o);const u=d.uvs;r.push(u.x0,u.y0,u.x1,u.y1,u.x3,u.y3,u.x2,u.y2);const g=Lt.get(Co);g.indexOffset=o,g.indexSize=n.length-o,g.attributeOffset=a,g.attributeSize=i.length/2-a,g.baseColor=s.style,g.alpha=s.alpha,g.texture=d,g.geometryData=e,t.push(g)}function Br(s,t,e,i,r){const{vertices:n,uvs:o,indices:a}=r;s.shapePrimitives.forEach(({shape:h,transform:c,holes:l})=>{const d=a.length,f=n.length/2,u=[],g=rs[h.type];let _="triangle-list";if(g.build(h,u),c&&vo(u,c),e){const S=h.closePath??!0,A=t;A.pixelLine?(hl(u,S,n,a),_="line-list"):al(u,A,!1,S,n,a)}else if(l){const S=[],A=u.slice();bl(l).forEach(P=>{S.push(A.length/2),A.push(...P)}),To(A,S,n,2,f,a,d)}else g.triangulate(u,n,2,f,a,d);const m=o.length/2,b=t.texture;if(b!==j.WHITE){const S=ml(yl,t,h,c);el(n,2,f,o,m,2,n.length/2-f,S)}else sl(o,m,2,n.length/2-f);const w=Lt.get(Co);w.indexOffset=d,w.indexSize=a.length-d,w.attributeOffset=f,w.attributeSize=n.length/2-f,w.baseColor=t.color,w.alpha=t.alpha,w.texture=b,w.geometryData=r,w.topology=_,i.push(w)})}function bl(s){const t=[];for(let e=0;e<s.length;e++){const i=s[e].shape,r=[];rs[i.type].build(i,r),t.push(r)}return t}class wl{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Sl{constructor(){this.batcher=new tl,this.instructions=new Gn}init(){this.instructions.reset()}get geometry(){return q(Ra,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Mi=class ri{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){ri.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??ri.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),xl(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Lt.get(Sl),{batches:i,geometryData:r}=this._gpuContextHash[t.uid],n=r.vertices.length,o=r.indices.length;for(let l=0;l<i.length;l++)i[l].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(n),a.ensureIndexBuffer(o),a.begin();for(let l=0;l<i.length;l++){const d=i[l];a.add(d)}a.finish(e.instructions);const h=a.geometry;h.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),h.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let l=0;l<c.length;l++){const d=c[l];d.bindGroup=pc(d.textures.textures,d.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new wl;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Lt.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{Lt.return(i)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Mi.extension={type:[Y.WebGLSystem,Y.WebGPUSystem,Y.CanvasSystem],name:"graphicsContext"};Mi.defaultOptions={bezierSmoothness:.5};let Mo=Mi;const vl=8,He=11920929e-14,Cl=1;function Po(s,t,e,i,r,n,o,a,h,c){const d=Math.min(.99,Math.max(0,c??Mo.defaultOptions.bezierSmoothness));let f=(Cl-d)/1;return f*=f,Al(t,e,i,r,n,o,a,h,s,f),s}function Al(s,t,e,i,r,n,o,a,h,c){ni(s,t,e,i,r,n,o,a,h,c,0),h.push(o,a)}function ni(s,t,e,i,r,n,o,a,h,c,l){if(l>vl)return;const d=(s+e)/2,f=(t+i)/2,u=(e+r)/2,g=(i+n)/2,_=(r+o)/2,m=(n+a)/2,b=(d+u)/2,w=(f+g)/2,S=(u+_)/2,A=(g+m)/2,k=(b+S)/2,P=(w+A)/2;if(l>0){let I=o-s,N=a-t;const L=Math.abs((e-o)*N-(i-a)*I),R=Math.abs((r-o)*N-(n-a)*I);if(L>He&&R>He){if((L+R)*(L+R)<=c*(I*I+N*N)){h.push(k,P);return}}else if(L>He){if(L*L<=c*(I*I+N*N)){h.push(k,P);return}}else if(R>He){if(R*R<=c*(I*I+N*N)){h.push(k,P);return}}else if(I=k-(s+o)/2,N=P-(t+a)/2,I*I+N*N<=c){h.push(k,P);return}}ni(s,t,d,f,b,w,k,P,h,c,l+1),ni(k,P,S,A,_,m,o,a,h,c,l+1)}const Tl=8,Ml=11920929e-14,Pl=1;function Il(s,t,e,i,r,n,o,a){const c=Math.min(.99,Math.max(0,a??Mo.defaultOptions.bezierSmoothness));let l=(Pl-c)/1;return l*=l,El(t,e,i,r,n,o,s,l),s}function El(s,t,e,i,r,n,o,a){oi(o,s,t,e,i,r,n,a,0),o.push(r,n)}function oi(s,t,e,i,r,n,o,a,h){if(h>Tl)return;const c=(t+i)/2,l=(e+r)/2,d=(i+n)/2,f=(r+o)/2,u=(c+d)/2,g=(l+f)/2;let _=n-t,m=o-e;const b=Math.abs((i-n)*m-(r-o)*_);if(b>Ml){if(b*b<=a*(_*_+m*m)){s.push(u,g);return}}else if(_=u-(t+n)/2,m=g-(e+o)/2,_*_+m*m<=a){s.push(u,g);return}oi(s,t,e,c,l,u,g,a,h+1),oi(s,u,g,d,f,n,o,a,h+1)}function Io(s,t,e,i,r,n,o,a){let h=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(h=2*Math.PI-h),a||(a=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)))),a=Math.max(a,3);let c=h/a,l=r;c*=o?-1:1;for(let d=0;d<a+1;d++){const f=Math.cos(l),u=Math.sin(l),g=t+f*i,_=e+u*i;s.push(g,_),l+=c}}function kl(s,t,e,i,r,n){const o=s[s.length-2],h=s[s.length-1]-e,c=o-t,l=r-e,d=i-t,f=Math.abs(h*d-c*l);if(f<1e-8||n===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const u=h*h+c*c,g=l*l+d*d,_=h*l+c*d,m=n*Math.sqrt(u)/f,b=n*Math.sqrt(g)/f,w=m*_/u,S=b*_/g,A=m*d+b*c,k=m*l+b*h,P=c*(b+w),I=h*(b+w),N=d*(m+S),L=l*(m+S),R=Math.atan2(I-k,P-A),B=Math.atan2(L-k,N-A);Io(s,A+t,k+e,n,R,B,c*l>d*h)}const Ce=Math.PI*2,Rs={centerX:0,centerY:0,ang1:0,ang2:0},Bs=({x:s,y:t},e,i,r,n,o,a,h)=>{s*=e,t*=i;const c=r*s-n*t,l=n*s+r*t;return h.x=c+o,h.y=l+a,h};function Rl(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,r=Math.cos(s),n=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:r-n*i,y:n+r*i},{x:o+a*i,y:a-o*i},{x:o,y:a}]}const Fr=(s,t,e,i)=>{const r=s*i-t*e<0?-1:1;let n=s*e+t*i;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},Bl=(s,t,e,i,r,n,o,a,h,c,l,d,f)=>{const u=Math.pow(r,2),g=Math.pow(n,2),_=Math.pow(l,2),m=Math.pow(d,2);let b=u*g-u*m-g*_;b<0&&(b=0),b/=u*m+g*_,b=Math.sqrt(b)*(o===a?-1:1);const w=b*r/n*d,S=b*-n/r*l,A=c*w-h*S+(s+e)/2,k=h*w+c*S+(t+i)/2,P=(l-w)/r,I=(d-S)/n,N=(-l-w)/r,L=(-d-S)/n,R=Fr(1,0,P,I);let B=Fr(P,I,N,L);a===0&&B>0&&(B-=Ce),a===1&&B<0&&(B+=Ce),f.centerX=A,f.centerY=k,f.ang1=R,f.ang2=B};function Fl(s,t,e,i,r,n,o,a=0,h=0,c=0){if(n===0||o===0)return;const l=Math.sin(a*Ce/360),d=Math.cos(a*Ce/360),f=d*(t-i)/2+l*(e-r)/2,u=-l*(t-i)/2+d*(e-r)/2;if(f===0&&u===0)return;n=Math.abs(n),o=Math.abs(o);const g=Math.pow(f,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(o,2);g>1&&(n*=Math.sqrt(g),o*=Math.sqrt(g)),Bl(t,e,i,r,n,o,h,c,l,d,f,u,Rs);let{ang1:_,ang2:m}=Rs;const{centerX:b,centerY:w}=Rs;let S=Math.abs(m)/(Ce/4);Math.abs(1-S)<1e-7&&(S=1);const A=Math.max(Math.ceil(S),1);m/=A;let k=s[s.length-2],P=s[s.length-1];const I={x:0,y:0};for(let N=0;N<A;N++){const L=Rl(_,m),{x:R,y:B}=Bs(L[0],n,o,d,l,b,w,I),{x:K,y:X}=Bs(L[1],n,o,d,l,b,w,I),{x:ot,y:Ft}=Bs(L[2],n,o,d,l,b,w,I);Po(s,k,P,R,B,K,X,ot,Ft),k=ot,P=Ft,_+=m}}function Dl(s,t,e){const i=(o,a)=>{const h=a.x-o.x,c=a.y-o.y,l=Math.sqrt(h*h+c*c),d=h/l,f=c/l;return{len:l,nx:d,ny:f}},r=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let n=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],h=a.radius??e;if(h<=0){r(o,a),n=a;continue}const c=t[(o+1)%t.length],l=i(a,n),d=i(a,c);if(l.len<1e-4||d.len<1e-4){r(o,a),n=a;continue}let f=Math.asin(l.nx*d.ny-l.ny*d.nx),u=1,g=!1;l.nx*d.nx-l.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,u=-1,g=!0):f>0&&(u=-1,g=!0);const _=f/2;let m,b=Math.abs(Math.cos(_)*h/Math.sin(_));b>Math.min(l.len/2,d.len/2)?(b=Math.min(l.len/2,d.len/2),m=Math.abs(b*Math.sin(_)/Math.cos(_))):m=h;const w=a.x+d.nx*b+-d.ny*m*u,S=a.y+d.ny*b+d.nx*m*u,A=Math.atan2(l.ny,l.nx)+Math.PI/2*u,k=Math.atan2(d.ny,d.nx)-Math.PI/2*u;o===0&&s.moveTo(w+Math.cos(A)*m,S+Math.sin(A)*m),s.arc(w,S,m,A,k,g),n=a}}function Gl(s,t,e,i){const r=(a,h)=>Math.sqrt((a.x-h.x)**2+(a.y-h.y)**2),n=(a,h,c)=>({x:a.x+(h.x-a.x)*c,y:a.y+(h.y-a.y)*c}),o=t.length;for(let a=0;a<o;a++){const h=t[(a+1)%o],c=h.radius??e;if(c<=0){a===0?s.moveTo(h.x,h.y):s.lineTo(h.x,h.y);continue}const l=t[a],d=t[(a+2)%o],f=r(l,h);let u;if(f<1e-4)u=h;else{const m=Math.min(f/2,c);u=n(h,l,m/f)}const g=r(d,h);let _;if(g<1e-4)_=h;else{const m=Math.min(g/2,c);_=n(h,d,m/g)}a===0?s.moveTo(u.x,u.y):s.lineTo(u.x,u.y),s.quadraticCurveTo(h.x,h.y,_.x,_.y,i)}}const Ll=new ht;class Nl{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new At,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,r=i[i.length-2],n=i[i.length-1];return(r!==t||n!==e)&&i.push(t,e),this}arc(t,e,i,r,n,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Io(a,t,e,i,r,n,o),this}arcTo(t,e,i,r,n){this._ensurePoly();const o=this._currentPoly.points;return kl(o,t,e,i,r,n),this}arcToSvg(t,e,i,r,n,o,a){const h=this._currentPoly.points;return Fl(h,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,o,a){this._ensurePoly();const h=this._currentPoly;return Po(this._currentPoly.points,h.lastX,h.lastY,t,e,i,r,n,o,a),this}quadraticCurveTo(t,e,i,r,n){this._ensurePoly();const o=this._currentPoly;return Il(this._currentPoly.points,o.lastX,o.lastY,t,e,i,r,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const i=this.shapePrimitives,r=i.length;for(let n=0;n<t.instructions.length;n++){const o=t.instructions[n];this[o.action](...o.data)}if(t.checkForHoles&&i.length-r>1){let n=null;for(let o=r;o<i.length;o++){const a=i[o];if(a.shape.type==="polygon"){const h=a.shape,c=n==null?void 0:n.shape;c&&c.containsPolygon(h)?(n.holes||(n.holes=[]),n.holes.push(a),i.copyWithin(o,o+1),i.length--,o--):n=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,r,n){return this.drawShape(new ht(t,e,i,r),n),this}circle(t,e,i,r){return this.drawShape(new Ci(t,e,i),r),this}poly(t,e,i){const r=new ve(t);return r.closePath=e,this.drawShape(r,i),this}regularPoly(t,e,i,r,n=0,o){r=Math.max(r|0,3);const a=-1*Math.PI/2+n,h=Math.PI*2/r,c=[];for(let l=0;l<r;l++){const d=a-l*h;c.push(t+i*Math.cos(d),e+i*Math.sin(d))}return this.poly(c,!0,o),this}roundPoly(t,e,i,r,n,o=0,a){if(r=Math.max(r|0,3),n<=0)return this.regularPoly(t,e,i,r,o);const h=i*Math.sin(Math.PI/r)-.001;n=Math.min(n,h);const c=-1*Math.PI/2+o,l=Math.PI*2/r,d=(r-2)*Math.PI/r/2;for(let f=0;f<r;f++){const u=f*l+c,g=t+i*Math.cos(u),_=e+i*Math.sin(u),m=u+Math.PI+d,b=u-Math.PI-d,w=g+n*Math.cos(m),S=_+n*Math.sin(m),A=g+n*Math.cos(b),k=_+n*Math.sin(b);f===0?this.moveTo(w,S):this.lineTo(w,S),this.quadraticCurveTo(g,_,A,k,a)}return this.closePath()}roundShape(t,e,i=!1,r){return t.length<3?this:(i?Gl(this,t,e,r):Dl(this,t,e),this.closePath())}filletRect(t,e,i,r,n){if(n===0)return this.rect(t,e,i,r);const o=Math.min(i,r)/2,a=Math.min(o,Math.max(-o,n)),h=t+i,c=e+r,l=a<0?-a:0,d=Math.abs(a);return this.moveTo(t,e+d).arcTo(t+l,e+l,t+d,e,d).lineTo(h-d,e).arcTo(h-l,e+l,h,e+d,d).lineTo(h,c-d).arcTo(h-l,c-l,t+i-d,c,d).lineTo(t+d,c).arcTo(t+l,c-l,t,c-d,d).closePath()}chamferRect(t,e,i,r,n,o){if(n<=0)return this.rect(t,e,i,r);const a=Math.min(n,Math.min(i,r)/2),h=t+i,c=e+r,l=[t+a,e,h-a,e,h,e+a,h,c-a,h-a,c,t+a,c,t,c-a,t,e+a];for(let d=l.length-1;d>=2;d-=2)l[d]===l[d-2]&&l[d-1]===l[d-3]&&l.splice(d-1,2);return this.poly(l,!0,o)}ellipse(t,e,i,r,n){return this.drawShape(new Ai(t,e,i,r),n),this}roundRect(t,e,i,r,n,o){return this.drawShape(new Ti(t,e,i,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new ve,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new ve,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,r=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,o=i;i=n.a*i+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this._currentPoly.points.push(i,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const r=e[i],n=r.shape.getBounds(Ll);r.transform?t.addRect(n,r.transform):t.addRect(n)}return t}}class pe{constructor(t,e=!1){this.instructions=[],this.uid=rt("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?ac(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new Nl(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,r,n){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(lt.shared);let h=0,c=0;if(!o||o.action!=="bezierCurveTo")h=a.x,c=a.y;else{h=o.data[2],c=o.data[3];const l=a.x,d=a.y;h=l+(l-h),c=d+(d-c)}return this.instructions.push({action:"bezierCurveTo",data:[h,c,t,e,i,r,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const r=this.instructions[this.instructions.length-1],n=this.getLastPoint(lt.shared);let o=0,a=0;if(!r||r.action!=="quadraticCurveTo")o=n.x,a=n.y;else{o=r.data[0],a=r.data[1];const h=n.x,c=n.y;o=h+(h-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,i]}),this._dirty=!0,this}rect(t,e,i,r,n){return this.instructions.push({action:"rect",data:[t,e,i,r,n]}),this._dirty=!0,this}circle(t,e,i,r){return this.instructions.push({action:"circle",data:[t,e,i,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,r,n,o,a){n||(n=r/2);const h=-1*Math.PI/2+o,c=i*2,l=Math.PI*2/c,d=[];for(let f=0;f<c;f++){const u=f%2?n:r,g=f*l+h;d.push(t+u*Math.cos(g),e+u*Math.sin(g))}return this.poly(d,!0,a),this}clone(t=!1){const e=new pe;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const r=this.instructions[i];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let h=0,c=0,l=0,d=0,f=0,u=0,g=0,_=0;for(let m=0;m<this.instructions.length;m++){const b=this.instructions[m],w=b.data;switch(b.action){case"moveTo":case"lineTo":h=w[0],c=w[1],w[0]=e*h+r*c+o,w[1]=i*h+n*c+a;break;case"bezierCurveTo":l=w[0],d=w[1],f=w[2],u=w[3],h=w[4],c=w[5],w[0]=e*l+r*d+o,w[1]=i*l+n*d+a,w[2]=e*f+r*u+o,w[3]=i*f+n*u+a,w[4]=e*h+r*c+o,w[5]=i*h+n*c+a;break;case"quadraticCurveTo":l=w[0],d=w[1],h=w[2],c=w[3],w[0]=e*l+r*d+o,w[1]=i*l+n*d+a,w[2]=e*h+r*c+o,w[3]=i*h+n*c+a;break;case"arcToSvg":h=w[5],c=w[6],g=w[0],_=w[1],w[0]=e*g+r*_,w[1]=i*g+n*_,w[5]=e*h+r*c+o,w[6]=i*h+n*c+a;break;case"circle":w[4]=xe(w[3],t);break;case"rect":w[4]=xe(w[4],t);break;case"ellipse":w[8]=xe(w[8],t);break;case"roundRect":w[5]=xe(w[5],t);break;case"addPath":w[0].transform(t);break;case"poly":w[2]=xe(w[2],t);break;default:xt("unknown transform action",b.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function xe(s,t){return s?s.prepend(t):t.clone()}function tt(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function Ol(s,t){const e=s.querySelectorAll("defs");for(let i=0;i<e.length;i++){const r=e[i];for(let n=0;n<r.children.length;n++){const o=r.children[n];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=$l(o);break;case"radialgradient":t.defs[o.id]=zl();break}}}}function $l(s){const t=tt(s,"x1",0),e=tt(s,"y1",0),i=tt(s,"x2",1),r=tt(s,"y2",0),n=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new se(t,e,i,r,n==="objectBoundingBox"?"local":"global");for(let a=0;a<s.children.length;a++){const h=s.children[a],c=tt(h,"offset",0),l=ut.shared.setValue(h.getAttribute("stop-color")).toNumber();o.addColorStop(c,l)}return o}function zl(s){return xt("[SVG Parser] Radial gradients are not yet supported"),new se(0,0,1,0)}function Dr(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Gr={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Eo(s,t){const e=s.getAttribute("style"),i={},r={},n={strokeStyle:i,fillStyle:r,useFill:!1,useStroke:!1};for(const o in Gr){const a=s.getAttribute(o);a&&Lr(t,n,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const h=o[a].trim(),[c,l]=h.split(":");Gr[c]&&Lr(t,n,c,l.trim())}}return{strokeStyle:n.useStroke?i:null,fillStyle:n.useFill?r:null,useFill:n.useFill,useStroke:n.useStroke}}function Lr(s,t,e,i){switch(e){case"stroke":if(i!=="none"){if(i.startsWith("url(")){const r=Dr(i);t.strokeStyle.fill=s.defs[r]}else t.strokeStyle.color=ut.shared.setValue(i).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(i);break;case"fill":if(i!=="none"){if(i.startsWith("url(")){const r=Dr(i);t.fillStyle.fill=s.defs[r]}else t.fillStyle.color=ut.shared.setValue(i).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(i);break;case"stroke-opacity":t.strokeStyle.alpha=Number(i);break;case"opacity":t.fillStyle.alpha=Number(i),t.strokeStyle.alpha=Number(i);break}}function Hl(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new pe};Ol(s,e);const i=s.children,{fillStyle:r,strokeStyle:n}=Eo(s,e);for(let o=0;o<i.length;o++){const a=i[o];a.nodeName.toLowerCase()!=="defs"&&ko(a,e,r,n)}return t}function ko(s,t,e,i){const r=s.children,{fillStyle:n,strokeStyle:o}=Eo(s,t);n&&e?e={...e,...n}:n&&(e=n),o&&i?i={...i,...o}:o&&(i=o);const a=!e&&!i;a&&(e={color:0});let h,c,l,d,f,u,g,_,m,b,w,S,A,k,P,I,N;switch(s.nodeName.toLowerCase()){case"path":k=s.getAttribute("d"),s.getAttribute("fill-rule")==="evenodd"&&xt("SVG Evenodd fill rule not supported, your svg may render incorrectly"),P=new pe(k,!0),t.context.path(P),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"circle":g=tt(s,"cx",0),_=tt(s,"cy",0),m=tt(s,"r",0),t.context.ellipse(g,_,m,m),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"rect":h=tt(s,"x",0),c=tt(s,"y",0),I=tt(s,"width",0),N=tt(s,"height",0),b=tt(s,"rx",0),w=tt(s,"ry",0),b||w?t.context.roundRect(h,c,I,N,b||w):t.context.rect(h,c,I,N),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"ellipse":g=tt(s,"cx",0),_=tt(s,"cy",0),b=tt(s,"rx",0),w=tt(s,"ry",0),t.context.beginPath(),t.context.ellipse(g,_,b,w),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"line":l=tt(s,"x1",0),d=tt(s,"y1",0),f=tt(s,"x2",0),u=tt(s,"y2",0),t.context.beginPath(),t.context.moveTo(l,d),t.context.lineTo(f,u),i&&t.context.stroke(i);break;case"polygon":A=s.getAttribute("points"),S=A.match(/\d+/g).map(L=>parseInt(L,10)),t.context.poly(S,!0),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"polyline":A=s.getAttribute("points"),S=A.match(/\d+/g).map(L=>parseInt(L,10)),t.context.poly(S,!1),i&&t.context.stroke(i);break;case"g":case"svg":break;default:{xt(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}a&&(e=null);for(let L=0;L<r.length;L++)ko(r[L],t,e,i)}function Wl(s){return ut.isColorLike(s)}function Nr(s){return s instanceof vi}function Or(s){return s instanceof se}function Ul(s){return s instanceof j}function Vl(s,t,e){const i=ut.shared.setValue(t??0);return s.color=i.toNumber(),s.alpha=i.alpha===1?e.alpha:i.alpha,s.texture=j.WHITE,{...e,...s}}function jl(s,t,e){return s.texture=t,{...e,...s}}function $r(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function zr(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function Yl(s,t){const e={...t,...s},i=ut.shared.setValue(e.color);return e.alpha*=i.alpha,e.color=i.toNumber(),e}function Qt(s,t){if(s==null)return null;const e={},i=s;return Wl(s)?Vl(e,s,t):Ul(s)?jl(e,s,t):Nr(s)?$r(e,s,t):Or(s)?zr(e,s,t):i.fill&&Nr(i.fill)?$r(i,i.fill,t):i.fill&&Or(i.fill)?zr(i,i.fill,t):Yl(i,t)}function Xe(s,t){const{width:e,alignment:i,miterLimit:r,cap:n,join:o,pixelLine:a,...h}=t,c=Qt(s,h);return c?{width:e,alignment:i,miterLimit:r,cap:n,join:o,pixelLine:a,...c}:null}const Xl=new lt,Hr=new z,Pi=class kt extends Rt{constructor(){super(...arguments),this.uid=rt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new pe,this._transform=new z,this._fillStyle={...kt.defaultFillStyle},this._strokeStyle={...kt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new At,this._boundsDirty=!0}clone(){const t=new kt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Qt(t,kt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Xe(t,kt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Qt(t,kt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Qt(t,kt.defaultStrokeStyle),this}texture(t,e,i,r,n,o){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:r||0,dw:n||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?ut.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new pe,this}fill(t,e){let i;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?i=r.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(q(et,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Qt(t,kt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(lt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Xe(t,kt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,r,n,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,i,r,n,o),this}arcTo(t,e,i,r,n){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,n),this}arcToSvg(t,e,i,r,n,o,a){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,i,r,n,h.a*o+h.c*a+h.tx,h.b*o+h.d*a+h.ty),this}bezierCurveTo(t,e,i,r,n,o,a){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*i+h.c*r+h.tx,h.b*i+h.d*r+h.ty,h.a*n+h.c*o+h.tx,h.b*n+h.d*o+h.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,i,r){return this._tick++,this._activePath.ellipse(t,e,i,r,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,r=this._activePath.instructions,n=i.a*t+i.c*e+i.tx,o=i.b*t+i.d*e+i.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=n,r[0].data[1]=o,this):(this._activePath.moveTo(n,o),this)}quadraticCurveTo(t,e,i,r,n){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,n),this}rect(t,e,i,r){return this._tick++,this._activePath.rect(t,e,i,r,this._transform.clone()),this}roundRect(t,e,i,r,n){return this._tick++,this._activePath.roundRect(t,e,i,r,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,r,n=0,o){return this._tick++,this._activePath.regularPoly(t,e,i,r,n,o),this}roundPoly(t,e,i,r,n,o){return this._tick++,this._activePath.roundPoly(t,e,i,r,n,o),this}roundShape(t,e,i,r){return this._tick++,this._activePath.roundShape(t,e,i,r),this}filletRect(t,e,i,r,n){return this._tick++,this._activePath.filletRect(t,e,i,r,n),this}chamferRect(t,e,i,r,n,o){return this._tick++,this._activePath.chamferRect(t,e,i,r,n,o),this}star(t,e,i,r,n=0,o=0){return this._tick++,this._activePath.star(t,e,i,r,n,o,this._transform.clone()),this}svg(t){return this._tick++,Hl(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,r,n,o){return t instanceof z?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,r,n,o),this)}transform(t,e,i,r,n,o){return t instanceof z?(this._transform.append(t),this):(Hr.set(t,e,i,r,n,o),this._transform.append(Hr),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],r=i.action;if(r==="fill"){const n=i.data;t.addBounds(n.path.bounds)}else if(r==="texture"){const n=i.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(r==="stroke"){const n=i.data,o=n.style.alignment,a=n.style.width*(1-o),h=n.path.bounds;t.addFrame(h.minX-a,h.minY-a,h.maxX+a,h.maxY+a)}}return t}containsPoint(t){var r;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let n=0;n<e.length;n++){const o=e[n],a=o.data,h=a.path;if(!o.action||!h)continue;const c=a.style,l=h.shapePath.shapePrimitives;for(let d=0;d<l.length;d++){const f=l[d].shape;if(!c||!f)continue;const u=l[d].transform,g=u?u.applyInverse(t,Xl):t;if(o.action==="fill")i=f.contains(g.x,g.y);else{const m=c;i=f.strokeContains(g.x,g.y,m.width,m.alignment)}const _=a.hole;if(_){const m=(r=_.shapePath)==null?void 0:r.shapePrimitives;if(m)for(let b=0;b<m.length;b++)m[b].shape.contains(g.x,g.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Pi.defaultFillStyle={color:16777215,alpha:1,texture:j.WHITE,matrix:null,fill:null,textureSpace:"local"};Pi.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:j.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let vt=Pi;const Wr=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function ql(s){const t=[];let e=0;for(let i=0;i<Wr.length;i++){const r=`_${Wr[i]}`;t[e++]=s[r]}return e=Ro(s._fill,t,e),e=Kl(s._stroke,t,e),e=Zl(s.dropShadow,t,e),t.join("-")}function Ro(s,t,e){var i;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(i=s.fill)==null?void 0:i.styleKey),e}function Kl(s,t,e){return s&&(e=Ro(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function Zl(s,t,e){return s&&(t[e++]=s.alpha,t[e++]=s.angle,t[e++]=s.blur,t[e++]=s.distance,t[e++]=ut.shared.setValue(s.color).toNumber()),e}const Ii=class ue extends Rt{constructor(t={}){super(),Ql(t);const e={...ue.defaultTextStyle,...t};for(const i in e){const r=i;this[r]=e[i]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...ue.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...ue.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...vt.defaultFillStyle,...t},()=>{this._fill=Qt({...this._originalFill},vt.defaultFillStyle)})),this._fill=Qt(t===0?"black":t,vt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...vt.defaultStrokeStyle,...t},()=>{this._stroke=Xe({...this._originalStroke},vt.defaultStrokeStyle)})),this._stroke=Xe(t,vt.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=ql(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=ue.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new ue({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var i,r,n,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const a=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(a),(r=this._originalFill)!=null&&r.texture&&this._originalFill.texture.destroy(a),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(a),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(i,r,n)=>(i[r]=n,e==null||e(r,n),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(ut.isColorLike(t)||t instanceof se||t instanceof vi)}};Ii.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Ii.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ai=Ii;function Ql(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=ai.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){q(et,"strokeThickness is now a part of stroke");const e=t.stroke;let i={};if(ut.isColorLike(e))i.color=e;else if(e instanceof se||e instanceof vi)i.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))i=e;else throw new Error("Invalid stroke value.");s.stroke={...i,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){q(et,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;s.fontSize==null?s.fontSize=ai.defaultTextStyle.fontSize:typeof s.fontSize=="string"?e=parseInt(s.fontSize,10):e=s.fontSize;const i=new se({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),r=t.fillGradientStops.map(n=>ut.shared.setValue(n).toNumber());r.forEach((n,o)=>{const a=o/(r.length-1);i.addColorStop(a,n)}),s.fill={fill:i}}}const Jl=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function tu(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Jl.includes(r)&&(r=`"${r}"`),e[i]=r}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const Fs={willReadFrequently:!0},Mt=class F{static get experimentalLetterSpacingSupported(){let t=F._experimentalLetterSpacingSupported;if(t!==void 0){const e=Ct.get().getCanvasRenderingContext2D().prototype;t=F._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,r,n,o,a,h,c){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=c}static measureText(t=" ",e,i=F._canvas,r=e.wordWrap){var w;const n=`${t}:${e.styleKey}`;if(F._measurementCache[n])return F._measurementCache[n];const o=tu(e),a=F.measureFont(o);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const h=F.__context;h.font=o;const l=(r?F._wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),d=new Array(l.length);let f=0;for(let S=0;S<l.length;S++){const A=F._measureText(l[S],e.letterSpacing,h);d[S]=A,f=Math.max(f,A)}const u=((w=e._stroke)==null?void 0:w.width)||0;let g=f+u;e.dropShadow&&(g+=e.dropShadow.distance);const _=e.lineHeight||a.fontSize;let m=Math.max(_,a.fontSize+u)+(l.length-1)*(_+e.leading);return e.dropShadow&&(m+=e.dropShadow.distance),new F(t,e,g,m,l,d,_+e.leading,f,a)}static _measureText(t,e,i){let r=!1;F.experimentalLetterSpacingSupported&&(F.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const n=i.measureText(t);let o=n.width;const a=-n.actualBoundingBoxLeft;let c=n.actualBoundingBoxRight-a;if(o>0)if(r)o-=e,c-=e;else{const l=(F.graphemeSegmenter(t).length-1)*e;o+=l,c+=l}return Math.max(o,c)}static _wordWrap(t,e,i=F._canvas){const r=i.getContext("2d",Fs);let n=0,o="",a="";const h=Object.create(null),{letterSpacing:c,whiteSpace:l}=e,d=F._collapseSpaces(l),f=F._collapseNewlines(l);let u=!d;const g=e.wordWrapWidth+c,_=F._tokenize(t);for(let m=0;m<_.length;m++){let b=_[m];if(F._isNewline(b)){if(!f){a+=F._addLine(o),u=!d,o="",n=0;continue}b=" "}if(d){const S=F.isBreakingSpace(b),A=F.isBreakingSpace(o[o.length-1]);if(S&&A)continue}const w=F._getFromCache(b,c,h,r);if(w>g)if(o!==""&&(a+=F._addLine(o),o="",n=0),F.canBreakWords(b,e.breakWords)){const S=F.wordWrapSplit(b);for(let A=0;A<S.length;A++){let k=S[A],P=k,I=1;for(;S[A+I];){const L=S[A+I];if(!F.canBreakChars(P,L,b,A,e.breakWords))k+=L;else break;P=L,I++}A+=I-1;const N=F._getFromCache(k,c,h,r);N+n>g&&(a+=F._addLine(o),u=!1,o="",n=0),o+=k,n+=N}}else{o.length>0&&(a+=F._addLine(o),o="",n=0);const S=m===_.length-1;a+=F._addLine(b,!S),u=!1,o="",n=0}else w+n>g&&(u=!1,a+=F._addLine(o),o="",n=0),(o.length>0||!F.isBreakingSpace(b)||u)&&(o+=b,n+=w)}return a+=F._addLine(o,!1),a}static _addLine(t,e=!0){return t=F._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,i,r){let n=i[t];return typeof n!="number"&&(n=F._measureText(t,e,r)+e,i[t]=n),n}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!F.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:F._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:F._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const n=t[r],o=t[r+1];if(F.isBreakingSpace(n,o)||F._isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,r,n){return!0}static wordWrapSplit(t){return F.graphemeSegmenter(t)}static measureFont(t){if(F._fonts[t])return F._fonts[t];const e=F._context;e.font=t;const i=e.measureText(F.METRICS_STRING+F.BASELINE_SYMBOL),r={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return F._fonts[t]=r,r}static clearMetrics(t=""){t?delete F._fonts[t]:F._fonts={}}static get _canvas(){if(!F.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",Fs);if(i!=null&&i.measureText)return F.__canvas=e,e;t=Ct.get().createCanvas()}catch{t=Ct.get().createCanvas()}t.width=t.height=10,F.__canvas=t}return F.__canvas}static get _context(){return F.__context||(F.__context=F._canvas.getContext("2d",Fs)),F.__context}};Mt.METRICS_STRING="|q";Mt.BASELINE_SYMBOL="M";Mt.BASELINE_MULTIPLIER=1.4;Mt.HEIGHT_MULTIPLIER=2;Mt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})();Mt.experimentalLetterSpacing=!1;Mt._fonts={};Mt._newlines=[10,13];Mt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Mt._measurementCache={};let eu=Mt;class Tt extends _i{constructor(t){t instanceof vt&&(t={context:t});const{context:e,roundPixels:i,...r}=t||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new vt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Tt(this._context.clone()):(this._ownedContext=null,new Tt(this._context))}lineStyle(t,e,i){q(et,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),i&&(r.alpha=i),this.context.strokeStyle=r,this}beginFill(t,e){q(et,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t!==void 0&&(i.color=t),e!==void 0&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){q(et,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==vt.defaultStrokeStyle.width||t.color!==vt.defaultStrokeStyle.color||t.alpha!==vt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return q(et,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return q(et,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return q(et,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return q(et,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return q(et,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return q(et,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class su extends _i{constructor(t,e){const{text:i,resolution:r,style:n,anchor:o,width:a,height:h,roundPixels:c,...l}=t;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=i??"",this.style=n,this.resolution=r??null,this.allowChildren=!1,this._anchor=new ft({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=c??!1,a!==void 0&&(this.width=a),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,i=this.bounds.height,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<=r+e&&(n=-i*this.anchor.y,t.y>=n&&t.y<=n+i)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function iu(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(q(et,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}class st extends su{constructor(...t){const e=iu(t,"Text");super(e,ai),this.renderPipeId="text"}updateBounds(){const t=this._bounds,e=this._anchor,i=eu.measureText(this._text,this._style),{width:r,height:n}=i;t.minX=-e._x*r,t.maxX=t.minX+r,t.minY=-e._y*n,t.maxY=t.minY+n}}wt.add(Sa,va);class ru{constructor(t,e,i,r){nt(this,"app");nt(this,"container");nt(this,"baseWidth");nt(this,"baseHeight");nt(this,"layoutCallbacks",[]);nt(this,"resize",()=>{const t=window.innerWidth,e=window.innerHeight,i=t/this.baseWidth,r=e/this.baseHeight,n=Math.min(i,r);this.app.renderer.resize(t,e),this.container.scale.set(n),this.container.x=(t-this.baseWidth*n)/2,this.container.y=(e-this.baseHeight*n)/2,this.layoutCallbacks.forEach(o=>o()),console.log("[Resizer] Resized to:",t,e,"Scale:",n.toFixed(2))});this.app=t,this.container=e,this.baseWidth=i,this.baseHeight=r,this.resize(),window.addEventListener("resize",this.resize)}addLayoutCallback(t){this.layoutCallbacks.push(t),t()}}function nu(){const s=new J,t=new Tt;t.beginFill(1052688),t.drawRect(0,0,1080,60),t.endFill(),s.addChild(t);const e=new st({text:"NecroNet",style:{fill:16777215,fontSize:28,fontFamily:"monospace"}});return e.anchor.set(.5),e.x=1080/2,e.y=60/2,e.eventMode="static",e.cursor="pointer",e.on("pointerdown",()=>{window.location.reload()}),s.addChild(e),s}const ou=()=>{};var Ur={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=function(s){const t=[];let e=0;for(let i=0;i<s.length;i++){let r=s.charCodeAt(i);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=r&63|128):(r&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(s.charCodeAt(++i)&1023),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=r&63|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=r&63|128)}return t},au=function(s){const t=[];let e=0,i=0;for(;e<s.length;){const r=s[e++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const n=s[e++];t[i++]=String.fromCharCode((r&31)<<6|n&63)}else if(r>239&&r<365){const n=s[e++],o=s[e++],a=s[e++],h=((r&7)<<18|(n&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(h>>10)),t[i++]=String.fromCharCode(56320+(h&1023))}else{const n=s[e++],o=s[e++];t[i++]=String.fromCharCode((r&15)<<12|(n&63)<<6|o&63)}}return t.join("")},Fo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,t){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<s.length;r+=3){const n=s[r],o=r+1<s.length,a=o?s[r+1]:0,h=r+2<s.length,c=h?s[r+2]:0,l=n>>2,d=(n&3)<<4|a>>4;let f=(a&15)<<2|c>>6,u=c&63;h||(u=64,o||(f=64)),i.push(e[l],e[d],e[f],e[u])}return i.join("")},encodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(s):this.encodeByteArray(Bo(s),t)},decodeString(s,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(s):au(this.decodeStringToByteArray(s,t))},decodeStringToByteArray(s,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<s.length;){const n=e[s.charAt(r++)],a=r<s.length?e[s.charAt(r)]:0;++r;const c=r<s.length?e[s.charAt(r)]:64;++r;const d=r<s.length?e[s.charAt(r)]:64;if(++r,n==null||a==null||c==null||d==null)throw new hu;const f=n<<2|a>>4;if(i.push(f),c!==64){const u=a<<4&240|c>>2;if(i.push(u),d!==64){const g=c<<6&192|d;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class hu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const cu=function(s){const t=Bo(s);return Fo.encodeByteArray(t,!0)},Do=function(s){return cu(s).replace(/\./g,"")},lu=function(s){try{return Fo.decodeString(s,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=()=>uu().__FIREBASE_DEFAULTS__,fu=()=>{if(typeof process>"u"||typeof Ur>"u")return;const s=Ur.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},pu=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=s&&lu(s[1]);return t&&JSON.parse(t)},mu=()=>{try{return ou()||du()||fu()||pu()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Go=()=>{var s;return(s=mu())===null||s===void 0?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function Lo(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Ei(){try{return typeof indexedDB=="object"}catch{return!1}}function ki(){return new Promise((s,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(i),s(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{var n;t(((n=r.error)===null||n===void 0?void 0:n.message)||"")}}catch(e){t(e)}})}function No(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu="FirebaseError";class oe extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=yu,Object.setPrototypeOf(this,oe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ns.prototype.create)}}class ns{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},r=`${this.service}/${t}`,n=this.errors[t],o=n?xu(n,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new oe(r,a,i)}}function xu(s,t){return s.replace(_u,(e,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const _u=/\{\$([^}]+)}/g;function qe(s,t){if(s===t)return!0;const e=Object.keys(s),i=Object.keys(t);for(const r of e){if(!i.includes(r))return!1;const n=s[r],o=t[r];if(Vr(n)&&Vr(o)){if(!qe(n,o))return!1}else if(n!==o)return!1}for(const r of i)if(!e.includes(r))return!1;return!0}function Vr(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=1e3,wu=2,Su=4*60*60*1e3,vu=.5;function jr(s,t=bu,e=wu){const i=t*Math.pow(e,s),r=Math.round(vu*i*(Math.random()-.5)*2);return Math.min(Su,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(s){return s&&s._delegate?s._delegate:s}class Vt{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new gu;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(n){if(r)return null;throw n}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Tu(t))try{this.getOrInitializeService({instanceIdentifier:Zt})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const n=this.getOrInitializeService({instanceIdentifier:r});i.resolve(n)}catch{}}}}clearInstance(t=Zt){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Zt){return this.instances.has(t)}getOptions(t=Zt){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[n,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);i===a&&o.resolve(r)}return r}onInit(t,e){var i;const r=this.normalizeInstanceIdentifier(e),n=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;n.add(t),this.onInitCallbacks.set(r,n);const o=this.instances.get(r);return o&&t(o,r),()=>{n.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const r of i)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Au(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Zt){return this.component?this.component.multipleInstances?t:Zt:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Au(s){return s===Zt?void 0:s}function Tu(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Cu(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Z;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Z||(Z={}));const Pu={debug:Z.DEBUG,verbose:Z.VERBOSE,info:Z.INFO,warn:Z.WARN,error:Z.ERROR,silent:Z.SILENT},Iu=Z.INFO,Eu={[Z.DEBUG]:"log",[Z.VERBOSE]:"log",[Z.INFO]:"info",[Z.WARN]:"warn",[Z.ERROR]:"error"},ku=(s,t,...e)=>{if(t<s.logLevel)return;const i=new Date().toISOString(),r=Eu[t];if(r)console[r](`[${i}]  ${s.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class $o{constructor(t){this.name=t,this._logLevel=Iu,this._logHandler=ku,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Z))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Pu[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Z.DEBUG,...t),this._logHandler(this,Z.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Z.VERBOSE,...t),this._logHandler(this,Z.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Z.INFO,...t),this._logHandler(this,Z.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Z.WARN,...t),this._logHandler(this,Z.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Z.ERROR,...t),this._logHandler(this,Z.ERROR,...t)}}const Ru=(s,t)=>t.some(e=>s instanceof e);let Yr,Xr;function Bu(){return Yr||(Yr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Fu(){return Xr||(Xr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zo=new WeakMap,hi=new WeakMap,Ho=new WeakMap,Ds=new WeakMap,Ri=new WeakMap;function Du(s){const t=new Promise((e,i)=>{const r=()=>{s.removeEventListener("success",n),s.removeEventListener("error",o)},n=()=>{e(Ht(s.result)),r()},o=()=>{i(s.error),r()};s.addEventListener("success",n),s.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&zo.set(e,s)}).catch(()=>{}),Ri.set(t,s),t}function Gu(s){if(hi.has(s))return;const t=new Promise((e,i)=>{const r=()=>{s.removeEventListener("complete",n),s.removeEventListener("error",o),s.removeEventListener("abort",o)},n=()=>{e(),r()},o=()=>{i(s.error||new DOMException("AbortError","AbortError")),r()};s.addEventListener("complete",n),s.addEventListener("error",o),s.addEventListener("abort",o)});hi.set(s,t)}let ci={get(s,t,e){if(s instanceof IDBTransaction){if(t==="done")return hi.get(s);if(t==="objectStoreNames")return s.objectStoreNames||Ho.get(s);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Ht(s[t])},set(s,t,e){return s[t]=e,!0},has(s,t){return s instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in s}};function Lu(s){ci=s(ci)}function Nu(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=s.call(Gs(this),t,...e);return Ho.set(i,t.sort?t.sort():[t]),Ht(i)}:Fu().includes(s)?function(...t){return s.apply(Gs(this),t),Ht(zo.get(this))}:function(...t){return Ht(s.apply(Gs(this),t))}}function Ou(s){return typeof s=="function"?Nu(s):(s instanceof IDBTransaction&&Gu(s),Ru(s,Bu())?new Proxy(s,ci):s)}function Ht(s){if(s instanceof IDBRequest)return Du(s);if(Ds.has(s))return Ds.get(s);const t=Ou(s);return t!==s&&(Ds.set(s,t),Ri.set(t,s)),t}const Gs=s=>Ri.get(s);function Wo(s,t,{blocked:e,upgrade:i,blocking:r,terminated:n}={}){const o=indexedDB.open(s,t),a=Ht(o);return i&&o.addEventListener("upgradeneeded",h=>{i(Ht(o.result),h.oldVersion,h.newVersion,Ht(o.transaction),h)}),e&&o.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),a.then(h=>{n&&h.addEventListener("close",()=>n()),r&&h.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const $u=["get","getKey","getAll","getAllKeys","count"],zu=["put","add","delete","clear"],Ls=new Map;function qr(s,t){if(!(s instanceof IDBDatabase&&!(t in s)&&typeof t=="string"))return;if(Ls.get(t))return Ls.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,r=zu.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(r||$u.includes(e)))return;const n=async function(o,...a){const h=this.transaction(o,r?"readwrite":"readonly");let c=h.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),r&&h.done]))[0]};return Ls.set(t,n),n}Lu(s=>({...s,get:(t,e,i)=>qr(t,e)||s.get(t,e,i),has:(t,e)=>!!qr(t,e)||s.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Wu(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function Wu(s){const t=s.getComponent();return(t==null?void 0:t.type)==="VERSION"}const li="@firebase/app",Kr="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t=new $o("@firebase/app"),Uu="@firebase/app-compat",Vu="@firebase/analytics-compat",ju="@firebase/analytics",Yu="@firebase/app-check-compat",Xu="@firebase/app-check",qu="@firebase/auth",Ku="@firebase/auth-compat",Zu="@firebase/database",Qu="@firebase/data-connect",Ju="@firebase/database-compat",td="@firebase/functions",ed="@firebase/functions-compat",sd="@firebase/installations",id="@firebase/installations-compat",rd="@firebase/messaging",nd="@firebase/messaging-compat",od="@firebase/performance",ad="@firebase/performance-compat",hd="@firebase/remote-config",cd="@firebase/remote-config-compat",ld="@firebase/storage",ud="@firebase/storage-compat",dd="@firebase/firestore",fd="@firebase/vertexai",pd="@firebase/firestore-compat",md="firebase";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui="[DEFAULT]",gd={[li]:"fire-core",[Uu]:"fire-core-compat",[ju]:"fire-analytics",[Vu]:"fire-analytics-compat",[Xu]:"fire-app-check",[Yu]:"fire-app-check-compat",[qu]:"fire-auth",[Ku]:"fire-auth-compat",[Zu]:"fire-rtdb",[Qu]:"fire-data-connect",[Ju]:"fire-rtdb-compat",[td]:"fire-fn",[ed]:"fire-fn-compat",[sd]:"fire-iid",[id]:"fire-iid-compat",[rd]:"fire-fcm",[nd]:"fire-fcm-compat",[od]:"fire-perf",[ad]:"fire-perf-compat",[hd]:"fire-rc",[cd]:"fire-rc-compat",[ld]:"fire-gcs",[ud]:"fire-gcs-compat",[dd]:"fire-fst",[pd]:"fire-fst-compat",[fd]:"fire-vertex","fire-js":"fire-js",[md]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ke=new Map,yd=new Map,di=new Map;function Zr(s,t){try{s.container.addComponent(t)}catch(e){$t.debug(`Component ${t.name} failed to register with FirebaseApp ${s.name}`,e)}}function ie(s){const t=s.name;if(di.has(t))return $t.debug(`There were multiple attempts to register component ${t}.`),!1;di.set(t,s);for(const e of Ke.values())Zr(e,s);for(const e of yd.values())Zr(e,s);return!0}function os(s,t){const e=s.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),s.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wt=new ns("app","Firebase",xd);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Vt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Wt.create("app-deleted",{appName:this._name})}}function Uo(s,t={}){let e=s;typeof t!="object"&&(t={name:t});const i=Object.assign({name:ui,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw Wt.create("bad-app-name",{appName:String(r)});if(e||(e=Go()),!e)throw Wt.create("no-options");const n=Ke.get(r);if(n){if(qe(e,n.options)&&qe(i,n.config))return n;throw Wt.create("duplicate-app",{appName:r})}const o=new Mu(r);for(const h of di.values())o.addComponent(h);const a=new _d(e,i,o);return Ke.set(r,a),a}function bd(s=ui){const t=Ke.get(s);if(!t&&s===ui&&Go())return Uo();if(!t)throw Wt.create("no-app",{appName:s});return t}function Ut(s,t,e){var i;let r=(i=gd[s])!==null&&i!==void 0?i:s;e&&(r+=`-${e}`);const n=r.match(/\s|\//),o=t.match(/\s|\//);if(n||o){const a=[`Unable to register library "${r}" with version "${t}":`];n&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),n&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),$t.warn(a.join(" "));return}ie(new Vt(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wd="firebase-heartbeat-database",Sd=1,Ee="firebase-heartbeat-store";let Ns=null;function Vo(){return Ns||(Ns=Wo(wd,Sd,{upgrade:(s,t)=>{switch(t){case 0:try{s.createObjectStore(Ee)}catch(e){console.warn(e)}}}}).catch(s=>{throw Wt.create("idb-open",{originalErrorMessage:s.message})})),Ns}async function vd(s){try{const e=(await Vo()).transaction(Ee),i=await e.objectStore(Ee).get(jo(s));return await e.done,i}catch(t){if(t instanceof oe)$t.warn(t.message);else{const e=Wt.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});$t.warn(e.message)}}}async function Qr(s,t){try{const i=(await Vo()).transaction(Ee,"readwrite");await i.objectStore(Ee).put(t,jo(s)),await i.done}catch(e){if(e instanceof oe)$t.warn(e.message);else{const i=Wt.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});$t.warn(i.message)}}}function jo(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=1024,Ad=30;class Td{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Pd(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Jr();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Ad){const o=Id(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){$t.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jr(),{heartbeatsToSend:i,unsentEntries:r}=Md(this._heartbeatsCache.heartbeats),n=Do(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(e){return $t.warn(e),""}}}function Jr(){return new Date().toISOString().substring(0,10)}function Md(s,t=Cd){const e=[];let i=s.slice();for(const r of s){const n=e.find(o=>o.agent===r.agent);if(n){if(n.dates.push(r.date),tn(e)>t){n.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),tn(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class Pd{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ei()?ki().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await vd(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return Qr(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const r=await this.read();return Qr(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function tn(s){return Do(JSON.stringify({version:2,heartbeats:s})).length}function Id(s){if(s.length===0)return-1;let t=0,e=s[0].date;for(let i=1;i<s.length;i++)s[i].date<e&&(e=s[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(s){ie(new Vt("platform-logger",t=>new Hu(t),"PRIVATE")),ie(new Vt("heartbeat",t=>new Td(t),"PRIVATE")),Ut(li,Kr,s),Ut(li,Kr,"esm2017"),Ut("fire-js","")}Ed("");var kd="firebase",Rd="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ut(kd,Rd,"app");const Yo="@firebase/installations",Bi="0.6.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=1e4,qo=`w:${Bi}`,Ko="FIS_v2",Bd="https://firebaseinstallations.googleapis.com/v1",Fd=60*60*1e3,Dd="installations",Gd="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},re=new ns(Dd,Gd,Ld);function Zo(s){return s instanceof oe&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo({projectId:s}){return`${Bd}/projects/${s}/installations`}function Jo(s){return{token:s.token,requestStatus:2,expiresIn:Od(s.expiresIn),creationTime:Date.now()}}async function ta(s,t){const i=(await t.json()).error;return re.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function ea({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function Nd(s,{refreshToken:t}){const e=ea(s);return e.append("Authorization",$d(t)),e}async function sa(s){const t=await s();return t.status>=500&&t.status<600?s():t}function Od(s){return Number(s.replace("s","000"))}function $d(s){return`${Ko} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zd({appConfig:s,heartbeatServiceProvider:t},{fid:e}){const i=Qo(s),r=ea(s),n=t.getImmediate({optional:!0});if(n){const c=await n.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const o={fid:e,authVersion:Ko,appId:s.appId,sdkVersion:qo},a={method:"POST",headers:r,body:JSON.stringify(o)},h=await sa(()=>fetch(i,a));if(h.ok){const c=await h.json();return{fid:c.fid||e,registrationStatus:2,refreshToken:c.refreshToken,authToken:Jo(c.authToken)}}else throw await ta("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ia(s){return new Promise(t=>{setTimeout(t,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=/^[cdef][\w-]{21}$/,fi="";function Ud(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const e=Vd(s);return Wd.test(e)?e:fi}catch{return fi}}function Vd(s){return Hd(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=new Map;function na(s,t){const e=as(s);oa(e,t),jd(e,t)}function oa(s,t){const e=ra.get(s);if(e)for(const i of e)i(t)}function jd(s,t){const e=Yd();e&&e.postMessage({key:s,fid:t}),Xd()}let Jt=null;function Yd(){return!Jt&&"BroadcastChannel"in self&&(Jt=new BroadcastChannel("[Firebase] FID Change"),Jt.onmessage=s=>{oa(s.data.key,s.data.fid)}),Jt}function Xd(){ra.size===0&&Jt&&(Jt.close(),Jt=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="firebase-installations-database",Kd=1,ne="firebase-installations-store";let Os=null;function Fi(){return Os||(Os=Wo(qd,Kd,{upgrade:(s,t)=>{switch(t){case 0:s.createObjectStore(ne)}}})),Os}async function Ze(s,t){const e=as(s),r=(await Fi()).transaction(ne,"readwrite"),n=r.objectStore(ne),o=await n.get(e);return await n.put(t,e),await r.done,(!o||o.fid!==t.fid)&&na(s,t.fid),t}async function aa(s){const t=as(s),i=(await Fi()).transaction(ne,"readwrite");await i.objectStore(ne).delete(t),await i.done}async function hs(s,t){const e=as(s),r=(await Fi()).transaction(ne,"readwrite"),n=r.objectStore(ne),o=await n.get(e),a=t(o);return a===void 0?await n.delete(e):await n.put(a,e),await r.done,a&&(!o||o.fid!==a.fid)&&na(s,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Di(s){let t;const e=await hs(s.appConfig,i=>{const r=Zd(i),n=Qd(s,r);return t=n.registrationPromise,n.installationEntry});return e.fid===fi?{installationEntry:await t}:{installationEntry:e,registrationPromise:t}}function Zd(s){const t=s||{fid:Ud(),registrationStatus:0};return ha(t)}function Qd(s,t){if(t.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(re.create("app-offline"));return{installationEntry:t,registrationPromise:r}}const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=Jd(s,e);return{installationEntry:e,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:tf(s)}:{installationEntry:t}}async function Jd(s,t){try{const e=await zd(s,t);return Ze(s.appConfig,e)}catch(e){throw Zo(e)&&e.customData.serverCode===409?await aa(s.appConfig):await Ze(s.appConfig,{fid:t.fid,registrationStatus:0}),e}}async function tf(s){let t=await en(s.appConfig);for(;t.registrationStatus===1;)await ia(100),t=await en(s.appConfig);if(t.registrationStatus===0){const{installationEntry:e,registrationPromise:i}=await Di(s);return i||e}return t}function en(s){return hs(s,t=>{if(!t)throw re.create("installation-not-found");return ha(t)})}function ha(s){return ef(s)?{fid:s.fid,registrationStatus:0}:s}function ef(s){return s.registrationStatus===1&&s.registrationTime+Xo<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sf({appConfig:s,heartbeatServiceProvider:t},e){const i=rf(s,e),r=Nd(s,e),n=t.getImmediate({optional:!0});if(n){const c=await n.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const o={installation:{sdkVersion:qo,appId:s.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},h=await sa(()=>fetch(i,a));if(h.ok){const c=await h.json();return Jo(c)}else throw await ta("Generate Auth Token",h)}function rf(s,{fid:t}){return`${Qo(s)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gi(s,t=!1){let e;const i=await hs(s.appConfig,n=>{if(!ca(n))throw re.create("not-registered");const o=n.authToken;if(!t&&af(o))return n;if(o.requestStatus===1)return e=nf(s,t),n;{if(!navigator.onLine)throw re.create("app-offline");const a=cf(n);return e=of(s,a),a}});return e?await e:i.authToken}async function nf(s,t){let e=await sn(s.appConfig);for(;e.authToken.requestStatus===1;)await ia(100),e=await sn(s.appConfig);const i=e.authToken;return i.requestStatus===0?Gi(s,t):i}function sn(s){return hs(s,t=>{if(!ca(t))throw re.create("not-registered");const e=t.authToken;return lf(e)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function of(s,t){try{const e=await sf(s,t),i=Object.assign(Object.assign({},t),{authToken:e});return await Ze(s.appConfig,i),e}catch(e){if(Zo(e)&&(e.customData.serverCode===401||e.customData.serverCode===404))await aa(s.appConfig);else{const i=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Ze(s.appConfig,i)}throw e}}function ca(s){return s!==void 0&&s.registrationStatus===2}function af(s){return s.requestStatus===2&&!hf(s)}function hf(s){const t=Date.now();return t<s.creationTime||s.creationTime+s.expiresIn<t+Fd}function cf(s){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:t})}function lf(s){return s.requestStatus===1&&s.requestTime+Xo<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uf(s){const t=s,{installationEntry:e,registrationPromise:i}=await Di(t);return i?i.catch(console.error):Gi(t).catch(console.error),e.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(s,t=!1){const e=s;return await ff(e),(await Gi(e,t)).token}async function ff(s){const{registrationPromise:t}=await Di(s);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(s){if(!s||!s.options)throw $s("App Configuration");if(!s.name)throw $s("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!s.options[e])throw $s(e);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function $s(s){return re.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="installations",mf="installations-internal",gf=s=>{const t=s.getProvider("app").getImmediate(),e=pf(t),i=os(t,"heartbeat");return{app:t,appConfig:e,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},yf=s=>{const t=s.getProvider("app").getImmediate(),e=os(t,la).getImmediate();return{getId:()=>uf(e),getToken:r=>df(e,r)}};function xf(){ie(new Vt(la,gf,"PUBLIC")),ie(new Vt(mf,yf,"PRIVATE"))}xf();Ut(Yo,Bi);Ut(Yo,Bi,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe="analytics",_f="firebase_id",bf="origin",wf=60*1e3,Sf="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Li="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt=new $o("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},_t=new ns("analytics","Analytics",vf);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(s){if(!s.startsWith(Li)){const t=_t.create("invalid-gtag-resource",{gtagURL:s});return mt.warn(t.message),""}return s}function ua(s){return Promise.all(s.map(t=>t.catch(e=>e)))}function Af(s,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(s,t)),e}function Tf(s,t){const e=Af("firebase-js-sdk-policy",{createScriptURL:Cf}),i=document.createElement("script"),r=`${Li}?l=${s}&id=${t}`;i.src=e?e==null?void 0:e.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function Mf(s){let t=[];return Array.isArray(window[s])?t=window[s]:window[s]=t,t}async function Pf(s,t,e,i,r,n){const o=i[r];try{if(o)await t[o];else{const h=(await ua(e)).find(c=>c.measurementId===r);h&&await t[h.appId]}}catch(a){mt.error(a)}s("config",r,n)}async function If(s,t,e,i,r){try{let n=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await ua(e);for(const h of o){const c=a.find(d=>d.measurementId===h),l=c&&t[c.appId];if(l)n.push(l);else{n=[];break}}}n.length===0&&(n=Object.values(t)),await Promise.all(n),s("event",i,r||{})}catch(n){mt.error(n)}}function Ef(s,t,e,i){async function r(n,...o){try{if(n==="event"){const[a,h]=o;await If(s,t,e,a,h)}else if(n==="config"){const[a,h]=o;await Pf(s,t,e,i,a,h)}else if(n==="consent"){const[a,h]=o;s("consent",a,h)}else if(n==="get"){const[a,h,c]=o;s("get",a,h,c)}else if(n==="set"){const[a]=o;s("set",a)}else s(n,...o)}catch(a){mt.error(a)}}return r}function kf(s,t,e,i,r){let n=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(n=window[r]),window[r]=Ef(n,s,t,e),{gtagCore:n,wrappedGtag:window[r]}}function Rf(s){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Li)&&e.src.includes(s))return e;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf=30,Ff=1e3;class Df{constructor(t={},e=Ff){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const da=new Df;function Gf(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function Lf(s){var t;const{appId:e,apiKey:i}=s,r={method:"GET",headers:Gf(i)},n=Sf.replace("{app-id}",e),o=await fetch(n,r);if(o.status!==200&&o.status!==304){let a="";try{const h=await o.json();!((t=h.error)===null||t===void 0)&&t.message&&(a=h.error.message)}catch{}throw _t.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Nf(s,t=da,e){const{appId:i,apiKey:r,measurementId:n}=s.options;if(!i)throw _t.create("no-app-id");if(!r){if(n)return{measurementId:n,appId:i};throw _t.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new zf;return setTimeout(async()=>{a.abort()},wf),fa({appId:i,apiKey:r,measurementId:n},o,a,t)}async function fa(s,{throttleEndTimeMillis:t,backoffCount:e},i,r=da){var n;const{appId:o,measurementId:a}=s;try{await Of(i,t)}catch(h){if(a)return mt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:a};throw h}try{const h=await Lf(s);return r.deleteThrottleMetadata(o),h}catch(h){const c=h;if(!$f(c)){if(r.deleteThrottleMetadata(o),a)return mt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw h}const l=Number((n=c==null?void 0:c.customData)===null||n===void 0?void 0:n.httpStatus)===503?jr(e,r.intervalMillis,Bf):jr(e,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+l,backoffCount:e+1};return r.setThrottleMetadata(o,d),mt.debug(`Calling attemptFetch again in ${l} millis`),fa(s,d,i,r)}}function Of(s,t){return new Promise((e,i)=>{const r=Math.max(t-Date.now(),0),n=setTimeout(e,r);s.addEventListener(()=>{clearTimeout(n),i(_t.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function $f(s){if(!(s instanceof oe)||!s.customData)return!1;const t=Number(s.customData.httpStatus);return t===429||t===500||t===503||t===504}class zf{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function Hf(s,t,e,i,r){if(r&&r.global){s("event",e,i);return}else{const n=await t,o=Object.assign(Object.assign({},i),{send_to:n});s("event",e,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wf(){if(Ei())try{await ki()}catch(s){return mt.warn(_t.create("indexeddb-unavailable",{errorInfo:s==null?void 0:s.toString()}).message),!1}else return mt.warn(_t.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Uf(s,t,e,i,r,n,o){var a;const h=Nf(s);h.then(u=>{e[u.measurementId]=u.appId,s.options.measurementId&&u.measurementId!==s.options.measurementId&&mt.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${u.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(u=>mt.error(u)),t.push(h);const c=Wf().then(u=>{if(u)return i.getId()}),[l,d]=await Promise.all([h,c]);Rf(n)||Tf(n,l.measurementId),r("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[bf]="firebase",f.update=!0,d!=null&&(f[_f]=d),r("config",l.measurementId,f),l.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(t){this.app=t}_delete(){return delete Ae[this.app.options.appId],Promise.resolve()}}let Ae={},rn=[];const nn={};let zs="dataLayer",jf="gtag",on,pa,an=!1;function Yf(){const s=[];if(Lo()&&s.push("This is a browser extension environment."),No()||s.push("Cookies are not available."),s.length>0){const t=s.map((i,r)=>`(${r+1}) ${i}`).join(" "),e=_t.create("invalid-analytics-context",{errorInfo:t});mt.warn(e.message)}}function Xf(s,t,e){Yf();const i=s.options.appId;if(!i)throw _t.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)mt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw _t.create("no-api-key");if(Ae[i]!=null)throw _t.create("already-exists",{id:i});if(!an){Mf(zs);const{wrappedGtag:n,gtagCore:o}=kf(Ae,rn,nn,zs,jf);pa=n,on=o,an=!0}return Ae[i]=Uf(s,rn,nn,t,on,zs,e),new Vf(s)}function qf(s=bd()){s=Oo(s);const t=os(s,Qe);return t.isInitialized()?t.getImmediate():Kf(s)}function Kf(s,t={}){const e=os(s,Qe);if(e.isInitialized()){const r=e.getImmediate();if(qe(t,e.getOptions()))return r;throw _t.create("already-initialized")}return e.initialize({options:t})}async function Zf(){if(Lo()||!No()||!Ei())return!1;try{return await ki()}catch{return!1}}function ma(s,t,e,i){s=Oo(s),Hf(pa,Ae[s.app.options.appId],t,e,i).catch(r=>mt.error(r))}const hn="@firebase/analytics",cn="0.10.12";function Qf(){ie(new Vt(Qe,(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();return Xf(i,r,e)},"PUBLIC")),ie(new Vt("analytics-internal",s,"PRIVATE")),Ut(hn,cn),Ut(hn,cn,"esm2017");function s(t){try{const e=t.getProvider(Qe).getImmediate();return{logEvent:(i,r,n)=>ma(e,i,r,n)}}catch(e){throw _t.create("interop-component-reg-failed",{reason:e})}}}Qf();const Jf={apiKey:"AIzaSyAJmdqUwjwgI_jKemOzdExs0_xc0mNDacY",authDomain:"necronet-bb085.firebaseapp.com",projectId:"necronet-bb085",storageBucket:"necronet-bb085.firebasestorage.app",messagingSenderId:"288833486211",appId:"1:288833486211:web:17209422a0a806a8694ab6",measurementId:"G-6Z40QYYE79"},tp=Uo(Jf);let pi=null;Zf().then(s=>{s&&(pi=qf(tp))});function de(s,t){pi&&ma(pi,s,t)}function ep(){const s=new J,t=new Tt;t.beginFill(1052688),t.drawRect(0,0,1080,60),t.endFill(),s.addChild(t);const e=new st({text:"Made by Alp Kurt",style:{fill:16777215,fontSize:16,fontFamily:"monospace"}});return e.anchor.set(.5),e.x=1080/2,e.y=60/2,e.eventMode="static",e.cursor="pointer",e.on("pointerdown",()=>{de("footer_link_clicked",{label:"alpkurt.com"}),window.open("https://alpkurt.com","_blank")}),s.addChild(e),s}class sp{constructor(t,e){nt(this,"app");nt(this,"root");nt(this,"currentScene",null);this.app=t,this.root=e}changeScene(t){this.currentScene&&(this.currentScene.onExit(),this.root.removeChild(this.currentScene.container));const e=typeof t=="function"?new t(this):t;this.currentScene=e,this.root.addChild(e.container),this.currentScene.onEnter()}getCurrentScene(){return this.currentScene}}const ct=1080,ke=1080;class Te{static save(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(i){console.error(`[LocalStorageManager] Failed to save key "${t}"`,i)}}static load(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.error(`[LocalStorageManager] Failed to load key "${t}"`,e),null}}static remove(t){try{localStorage.removeItem(t)}catch(e){console.error(`[LocalStorageManager] Failed to remove key "${t}"`,e)}}static clear(){try{localStorage.clear()}catch(t){console.error("[LocalStorageManager] Failed to clear localStorage",t)}}}const ln="fetchedPeople",ts=class ts{static loadFromStorage(){return Te.load(ln)||[]}static saveToStorage(){Te.save(ln,this.people)}static getAll(){return[...this.people]}static getPerson(t){return this.people.find(e=>e.id===t)}static addPerson(t){this.people.push(t),this.saveToStorage()}static removePerson(t){this.people=this.people.filter(e=>e.id!==t),this.saveToStorage()}static clearAll(){this.people=[],this.saveToStorage()}};nt(ts,"people",ts.loadFromStorage());let te=ts;const Hs="selectedPerson",es=class es{static loadFromStorage(){return Te.load(Hs)||null}static saveToStorage(){this.selected?Te.save(Hs,this.selected):Te.remove(Hs)}static get(){return this.selected}static set(t){this.selected=t,this.saveToStorage()}static clear(){this.selected=null,this.saveToStorage()}};nt(es,"selected",es.loadFromStorage());let Ot=es;class ip{static determineTypeFromPhone(t){const e=t.replace(/\D/g,""),i=parseInt(e[e.length-1]);return[0,1,2].includes(i)?"Smart Asshole":[3,4,5].includes(i)?"Simple Soul":[6,7].includes(i)?"Shameless Humorist":"Normie"}}class rp{static fromAPI(t){const e=t.login.uuid,i=`${t.name.first} ${t.name.last}`,r=`https://api.dicebear.com/8.x/notionists/png?seed=${encodeURIComponent(i)}`,n=t.dob.age,o=t.gender,a=`${t.location.city}, ${t.location.country}`,h=ip.determineTypeFromPhone(t.phone);return{id:e,fullName:i,avatarUrl:r,age:n,gender:o,location:a,type:h}}}class np extends J{constructor(){super();nt(this,"selectedId",null);this.init()}async init(){let e=te.getAll();e.length===0&&(await this.fetchAndStorePeople(3),e=te.getAll());const i=Ot.get();i?this.selectedId=i.id:e.length>0&&(this.selectedId=e[0].id,Ot.set(e[0])),this.renderPeople(e)}async fetchAndStorePeople(e){try{(await(await fetch(`https://randomuser.me/api/?results=${e}`)).json()).results.forEach(n=>{const o=rp.fromAPI(n);te.addPerson(o),de("person_fetched")})}catch(i){console.error("[PeopleList] Failed to fetch people:",i)}}async renderPeople(e){const i=window.innerWidth<=600,r=i?340:840,n=i?140:120,o=96,a=i?28:32,h=i?24:28,c=i?16:24;let l=0;for(const d of e){const f=new J;f.eventMode="static",f.cursor="pointer";const u=new Tt;u.beginFill(this.selectedId===d.id?3952248:2894892),u.drawRoundedRect(0,0,r,n,12),u.endFill(),f.addChild(u),f.on("pointerover",()=>u.tint=5592405),f.on("pointerout",()=>u.tint=16777215),f.on("pointerdown",()=>{this.selectedId=d.id,Ot.set(d),this.removeChildren(),this.renderPeople(e)});const _=await(await fetch(d.avatarUrl)).blob(),m=await createImageBitmap(_),b=new ee(j.from(m));b.width=o,b.height=o,b.x=c,b.y=(n-o)/2,f.addChild(b);const w=new st({text:`${d.fullName}, `,style:{fill:16777215,fontSize:a,fontFamily:"monospace",fontWeight:"bold"}}),S=new st({text:d.type,style:{fill:59110,fontSize:a,fontFamily:"monospace",fontStyle:"italic"}}),A=new st({text:`${d.age}, ${d.gender}, ${d.location}`,style:{fill:13421772,fontSize:h,fontFamily:"monospace"}});w.x=b.x+b.width+c,w.y=c,S.x=w.x+w.width,S.y=w.y,A.x=w.x,A.y=w.y+a+6,f.addChild(w,S,A),f.y=l,this.addChild(f),l+=n+16}}}const Ws="lastAction",Je={set(s){localStorage.setItem(Ws,s)},get(){const s=localStorage.getItem(Ws);return s==="killed"||s==="released"?s:null},clear(){localStorage.removeItem(Ws)}};class un{constructor(t){nt(this,"container");this.sceneManager=t,this.container=new J;const e=Je.get(),i=e==="killed"?` 
The soul has been harvested...
Your credits will be increased soon...`:e==="released"?` 
The soul has been released...
 You better have a good reason to do this...`:` Something mysterious happened...
Returning to task list...`,r=new st({text:i,style:{fill:65484,fontSize:28,fontFamily:"monospace",align:"center",wordWrap:!0,wordWrapWidth:ct-100}});r.anchor.set(.5),r.x=ct/2,r.y=300,this.container.addChild(r),setTimeout(()=>{Je.clear(),this.sceneManager.changeScene(ga)},3e3)}onEnter(){console.log("[ResultsScene] Entered")}onExit(){console.log("[ResultsScene] Exited")}}const dn=["happy","sad","tiring","monotone"],fn=["welcomes you","was not ready for you","loses their mind in confusion","suppresses their emotions","bursts out a laugh","starts crying","starts a live stream for their followers","acts like they understood who you are"];function op(s){const t=dn[Math.floor(Math.random()*dn.length)],e=Math.floor(Math.random()*s.age)+1;return`${s.fullName} is living a ${t} life in ${s.location} for ${e} years...`}function ap(s){const t=fn[Math.floor(Math.random()*fn.length)],e=s.gender.toLowerCase()==="male"?"He":"She";return`When ${e} sees you, ${e.toLowerCase()} ${t}...`}function pn(s){const e={"Smart Asshole":[`With big hopes to convince you, ${s.fullName} puts their hands into their pockets and shares this fact with an extraordinary confidence...`,`With a stunning confidence for what they have in their mind, ${s.fullName} closes their eyes and says...`,`To prove you they are too smart to die, ${s.fullName} says these words while pointing their head...`],"Simple Soul":[`Because ${s.fullName} won't be able to use it again, they start using 100% of their brain to come up with the best excuse so far...`,`Believing that it can convince you, ${s.fullName} checks their memory to remember a nice excuse they saw on social media...`,`To give their most acceptable excuse a shot, ${s.fullName} suddenly clicks their fingers and says...`],"Shameless Humorist":[`To make you believe their life is already a big joke, ${s.fullName} smiles and then breaks the silence with these words...`,`Thinking that a good joke is the solution to any issue, ${s.fullName} stares at you with empty eyes and drops these lines...`,`While their eyes start glowing, ${s.fullName} intensifies and starts floating in the air right before communicating these words...`],Normie:[`To impress you, ${s.fullName} tries to say something meaningful...`,`In order not to stay actless, ${s.fullName} attempts to describe what they saw on a reel yesterday...`,`To confuse you, ${s.fullName} clears their throat and makes a weird face before speaking...`]}[s.type];return e[Math.floor(Math.random()*e.length)]}async function mn(){const s=new st({text:"Loading fact...",style:{fill:16777215,fontSize:20,wordWrap:!0,wordWrapWidth:400,fontFamily:"monospace"}});s.anchor.set(.5);try{const e=await(await fetch("https://uselessfacts.jsph.pl/api/v2/facts/random?language=en")).json();e!=null&&e.text?s.text=e.text:s.text="No fact found "}catch(t){s.text="Failed to fetch fact ",console.error(t)}return s}async function gn(){const s=new st({text:"Loading excuse...",style:{fill:16777215,fontSize:20,wordWrap:!0,wordWrapWidth:400,fontFamily:"monospace"}});s.anchor.set(.5);try{const e=await(await fetch("https://excuser-three.vercel.app/v1/excuse")).json();Array.isArray(e)&&e.length>0&&e[0].excuse?s.text=e[0].excuse:s.text="No excuse found"}catch(t){s.text="Failed to fetch excuse",console.error(t)}return s}async function yn(){const s=new st({text:"Loading joke...",style:{fill:16777215,fontSize:20,wordWrap:!0,wordWrapWidth:400,fontFamily:"monospace"}});s.anchor.set(.5);try{const e=await(await fetch("https://v2.jokeapi.dev/joke/Any?type=single")).json();!e.error&&e.joke?s.text=e.joke:s.text="No joke found "}catch(t){s.text="Failed to fetch joke ",console.error(t)}return s}async function xn(s){switch(s){case"Smart Asshole":return await mn();case"Simple Soul":return await gn();case"Shameless Humorist":return await yn();case"Normie":default:const t=[mn,gn,yn],e=t[Math.floor(Math.random()*t.length)];return await e()}}async function _n(s,t,e,i=!1){const r=e||new st({text:"",style:{fill:16777215,fontSize:24,fontFamily:"monospace",wordWrap:!0,wordWrapWidth:ct-60}});r.anchor.set(.5),r.x=ct/2,r.y=500;const n=new st({text:"Click to continue...",style:{fill:11184810,fontSize:16,fontFamily:"monospace",fontStyle:"italic"}});n.anchor.set(.5),n.x=ct/2,n.y=r.y+60,e||s.addChild(r);const o=new Tt;o.beginFill(0,0),o.drawRect(0,0,ct,ke),o.endFill(),o.eventMode="static",o.cursor="pointer",s.addChild(o);const a=i?[()=>pn(t),()=>xn(t.type).then(c=>c.text)]:[()=>op(t),()=>ap(t),()=>pn(t),()=>xn(t.type).then(c=>c.text)];let h=0;return new Promise(c=>{const l=async()=>{const d=h===a.length-1;if(h<a.length){const f=await a[h++]();r.text=f,!d&&!s.children.includes(n)?s.addChild(n):d&&s.children.includes(n)&&s.removeChild(n)}else s.removeChild(o),s.children.includes(n)&&s.removeChild(n),c(r)};o.on("pointerdown",l),l()})}async function hp(s,t){const e=new ee;e.anchor.set(.5),e.x=ct/2,e.y=180,e.width=180,e.height=180,s.addChild(e);try{const o=await(await fetch(t.avatarUrl)).blob(),a=await createImageBitmap(o);e.texture=j.from(a)}catch(n){console.warn("[Header] Failed to load avatar:",n)}const i=new st({text:t.fullName,style:{fill:16777215,fontSize:36,fontFamily:"monospace",fontWeight:"bold"}});i.anchor.set(.5),i.x=ct/2,i.y=e.y+e.height/2+20,s.addChild(i);const r=new st({text:t.type,style:{fill:11184810,fontSize:22,fontFamily:"monospace",fontStyle:"italic"}});r.anchor.set(.5),r.x=ct/2,r.y=i.y+36,s.addChild(r)}function Us(s,t,e){const i=new J,r=360,n=56,o=new Tt;o.beginFill(2894892),o.drawRoundedRect(0,0,r,n,12),o.endFill();const a=new st({text:s,style:{fill:16777215,fontSize:22,fontFamily:"monospace",fontWeight:"bold"}});return a.anchor.set(.5),a.x=r/2,a.y=n/2,i.x=(ct-r)/2,i.y=t,i.eventMode="static",i.cursor="pointer",i.on("pointerdown",e),i.on("pointerover",()=>{o.tint=5592405}),i.on("pointerout",()=>{o.tint=16777215}),i.addChild(o,a),i}class cp{constructor(t){nt(this,"container");nt(this,"narrationTextRef",null);this.sceneManager=t,this.container=new J,this.init()}async init(){const t=Ot.get();if(!t){const o=new st({text:"No person selected.",style:{fill:16733525,fontSize:32,fontFamily:"monospace"}});o.anchor.set(.5),o.x=ct/2,o.y=200,this.container.addChild(o);return}hp(this.container,t),this.narrationTextRef=await _n(this.container,t);const e=700,i=Us(" Take their soul",e,()=>{de("soul_killed"),Je.set("killed"),te.removePerson(t.id),Ot.clear(),this.sceneManager.changeScene(un)}),r=Us(" Release Them",e+60,()=>{de("soul_released"),Je.set("released"),te.removePerson(t.id),Ot.clear(),this.sceneManager.changeScene(un)}),n=Us(" Give Another Chance",e+120,async()=>{de("soul_given_another_chance"),this.narrationTextRef&&(this.narrationTextRef.text="",this.narrationTextRef.eventMode="static",this.narrationTextRef.cursor="pointer"),this.narrationTextRef=await _n(this.container,t,this.narrationTextRef??void 0,!0)});this.container.addChild(i,r,n)}onEnter(){console.log("[GameScene] Entered")}onExit(){console.log("[GameScene] Exited")}}class ga{constructor(t){nt(this,"container");this.sceneManager=t,this.container=new J;const e=new np;e.x=(ct-800)/2,e.y=100,this.container.addChild(e);const i=new Tt;i.beginFill(52326),i.drawRect(0,0,200,50),i.endFill(),i.x=(ct-200)/2,i.y=ke-100,i.eventMode="static",i.cursor="pointer";const r=new st({text:"Go ",style:{fill:16777215,fontSize:24,fontFamily:"monospace"}});r.anchor.set(.5),r.x=100,r.y=25,i.addChild(r),i.on("pointerdown",()=>{Ot.get()?(de("task_initiated"),this.sceneManager.changeScene(cp)):console.warn("[TaskSelection] No selected person found.")}),this.container.addChild(i)}onEnter(){console.log("[TaskSelection] Entered")}onExit(){console.log("[TaskSelection] Exited")}}class lp{constructor(t){nt(this,"container");this.sceneManager=t,this.container=new J;const e=new J;e.x=ct/2;const i=new st({text:"Before You Continue...",style:{fill:16777215,fontSize:40,fontFamily:"monospace",fontWeight:"bold",align:"center"}});i.anchor.set(.5),i.y=0,e.addChild(i);const r=new st({text:`NecroNet uses Google Analytics to understand engagement,
and relies on public 3rd-party APIs to retrieve peoples data.

We dont control what those services do, and were not liable
for how those people talk to you or they log data.

NecroNet is purely for fun, and providing you extra income...`,style:{fill:11184810,fontSize:20,fontFamily:"monospace",align:"center",wordWrap:!0,wordWrapWidth:800}});r.anchor.set(.5),r.y=i.y+100,e.addChild(r);const n=this.createButton(" Accept & Continue",()=>{this.sceneManager.changeScene(ga)}),o=this.createButton(" Refuse & Refresh",()=>{location.reload()});n.y=r.y+180,o.y=n.y+80,e.addChild(n,o),e.pivot.set(0,e.height/2),e.y=ke/2,this.container.addChild(e)}createButton(t,e){const i=new J,r=new Tt;r.beginFill(2236962),r.drawRoundedRect(0,0,320,60,12),r.endFill(),r.eventMode="static",r.cursor="pointer";const n=new st({text:t,style:{fill:16777215,fontSize:20,fontFamily:"monospace",fontWeight:"bold"}});return n.anchor.set(.5),n.x=160,n.y=30,i.addChild(r,n),i.x=-160,r.on("pointerover",()=>r.tint=4473924),r.on("pointerout",()=>r.tint=16777215),r.on("pointerdown",e),i}onEnter(){console.log("[ConsentScene] Entered")}onExit(){console.log("[ConsentScene] Exited")}}class up{constructor(t){nt(this,"container");this.sceneManager=t,this.container=new J;const e=new J,i=new st({text:"Welcome, Freelancer!",style:{fill:16777215,fontSize:60,fontFamily:"monospace",fontWeight:"bold"}});i.anchor.set(.5),i.x=ct/2;const r=new st({text:`NecroNet is the leading SaaS platform for soul collection.
Join our network, track the souls, and secure your revenue stream.

Your targets are waiting...`,style:{fill:11184810,fontSize:22,fontFamily:"monospace",align:"center",wordWrap:!0,wordWrapWidth:720}});r.anchor.set(.5),r.x=ct/2;const n=this.createStartButton("Enter NecroNet",()=>{this.sceneManager.changeScene(lp)});n.x=(ct-n.width)/2,i.y=0,r.y=i.y+100,n.y=r.y+160,e.addChild(i,r,n),e.y=(ke-(n.y+60))/2,this.container.addChild(e)}createStartButton(t,e){const i=new J,r=new Tt;r.beginFill(65484),r.drawRoundedRect(0,0,320,60,12),r.endFill(),r.eventMode="static",r.cursor="pointer";const n=new st({text:t,style:{fill:0,fontSize:24,fontFamily:"monospace",fontWeight:"bold"}});return n.anchor.set(.5),n.x=160,n.y=30,r.on("pointerover",()=>r.tint=52394),r.on("pointerout",()=>r.tint=16777215),r.on("pointerdown",e),i.addChild(r,n),i}onEnter(){console.log("[MainMenuScene] Entered")}onExit(){console.log("[MainMenuScene] Exited")}}(async()=>{const s=new fo;await s.init({backgroundColor:1973790,resolution:window.devicePixelRatio||1,autoDensity:!0}),document.body.appendChild(s.canvas);const t=new J,e=new J;s.stage.addChild(t),s.stage.addChild(e);const i=new sp(s,t);i.changeScene(new up(i));const r=nu(),n=ep();e.addChild(r),e.addChild(n);function o(){r.x=0,r.y=0,r.width=window.innerWidth,n.x=0,n.y=window.innerHeight-60,n.width=window.innerWidth}window.addEventListener("resize",o),o(),new ru(s,t,ct,ke)})();export{co as $,ho as A,pt as B,J as C,Ct as D,Y as E,At as F,is as G,dh as H,tr as I,ee as J,Nh as K,Yh as L,z as M,rt as N,ht as O,lt as P,Zh as Q,Js as R,yc as S,Ge as T,Ks as U,sr as V,_s as W,rr as X,mh as Y,ut as Z,Bn as _,Rt as a,q as a0,et as a1,sc as a2,vc as a3,Hc as a4,Uc as a5,qc as a6,Zc as a7,Qc as a8,vi as a9,se as aa,tu as ab,eu as ac,Ye as ad,ai as ae,le as af,ql as ag,Co as ah,br as ai,xr as aj,Fa as ak,Tt as al,Ga as am,Mo as an,Pe as b,Ue as c,bi as d,wt as e,_r as f,pc as g,no as h,Wn as i,Bt as j,ro as k,zc as l,Wc as m,Hi as n,Yc as o,Kc as p,po as q,qa as r,wi as s,j as t,to as u,Da as v,xt as w,tl as x,Lt as y,En as z};
